import{r as o,j as e,R as At}from"./react-D3M8TY1j.js";import{c as Lt}from"./react-dom-BmarRHPO.js";import{c as Dt}from"./zustand-CtzhvQNp.js";import{i as It}from"./sql.js-CuHZ-FvZ.js";import{F as Ee}from"./file-saver-F0T0zIVO.js";import{f as kt}from"./sql-formatter-DiuGdjS8.js";import{I as Ft,H as Ot,c as ve,d as Re,e as Mt,S as Pt,f as Bt,g as Te,h as qt,i as Ut,j as Se,k as Ae,l as Le,m as $t,n as De,o as Qt,p as Ie,q as ke,r as zt,s as Fe,V as Ht,L as Oe,t as Me,u as Vt,v as Gt,w as Pe,x as _t,G as Wt,y as Kt,z as Be,A as Yt,B as Xt,E as qe,F as Ue,J as $e,K as Qe,M as ze,N as He,Q as Jt,U as Zt}from"./@radix-ui-DaOuI3kJ.js";import{c as es}from"./clsx-B-dksMZM.js";import{t as ts}from"./tailwind-merge-D696Ktp4.js";import{C as te,L as ss,I as as,a as rs,T as os,F as ns,b as ls,R as is,c as Ve,P as Ge,S as _e,K as cs,d as ds,e as ms,f as us,H as xs,g as fs,h as ps,i as hs,j as gs,M as bs,k as ys,l as js,m as Ns,n as ws,A as Cs,o as Es,p as vs,q as Rs,r as Ts,s as Ss,t as As,G as Ls,Z as Ds,u as Is,v as ks,w as Fs,x as Os}from"./lucide-react-C-w2aG6B.js";import{c as se}from"./class-variance-authority-Dp3B9jqt.js";import{t as D,B as Ms}from"./sonner-VQOJD9pj.js";import{D as R}from"./vaul-ciw04mCd.js";import{p as We,i as Ke,f as Ps,a as Bs}from"./date-fns-BAPXOope.js";import{G as qs,I as Us,t as $s}from"./@codemirror-C4AsP_wl.js";import{R as Qs,n as zs}from"./@uiw-D8zmkeY9.js";import{u as Hs}from"./react-dropzone-B3KUhKXm.js";import"./attr-accept-DSH7EMVE.js";import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-VneTDiFH.js";import"./nearley-BSN8dlhD.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-B-0e9Fff.js";import"./tslib-eMSY344_.js";import"./react-remove-scroll-bar-ltbdJw3o.js";import"./react-style-singleton-CwOSn0xs.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-D5kLLNSR.js";import"./use-callback-ref-D6xm71oD.js";import"./@floating-ui-CKQJRgKf.js";import"./@lezer-C0lltmwB.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@babel-BjXSgPXB.js";import"./prop-types-C70NJO-m.js";import"./file-selector-Bf0AE8ON.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();const Vs="/sql.wasm";let Y;const Gs=async()=>(Y||(Y=await It({locateFile:()=>Vs})),Y),_s=async t=>{try{const s=await Gs();return new s.Database(t)}catch(s){throw console.error("Failed to load database:",s),s}},ae=t=>{try{const s=t.prepare("SELECT name FROM sqlite_master WHERE type='table';"),a=[];for(;s.step();)a.push(s.get()[0]);return s.free(),a}catch{throw new Error("Invalid database file")}},Ws=(t,s)=>{try{const a={},r=t.prepare(`PRAGMA table_info("${s}");`);for(;r.step();){const l=r.getAsObject();a[l.name]={type:l.type?l.type.toUpperCase():l.type,isPrimaryKey:l.pk===1,isForeignKey:!1,nullable:l.notnull===0}}r.free();const n=t.prepare(`PRAGMA foreign_key_list("${s}");`);for(;n.step();){const l=n.getAsObject();a[l.from]&&(a[l.from].isForeignKey=!0)}return n.free(),a}catch(a){throw console.error(`Failed to get schema for table "${s}":`,a),a}},be=t=>{if(t.length===0)return{data:[],columns:[]};const{columns:s,values:a}=t[0];return{data:a.map(n=>Object.fromEntries(s.map((l,i)=>[l,n[i]]))),columns:s}},Ks=t=>{try{const s=t.export(),a=new Blob([s],{type:"application/x-sqlite3"});Ee.saveAs(a,"database.sqlite")}catch(s){throw console.error("Failed to export database:",s),s}},Ys=(t,s)=>{const a=t.map(n=>`"${n}"`).join(","),r=s.map(n=>t.map(l=>`"${n[l]??""}"`).join(","));return[a,...r].join(`
`)},re=(t,s,a)=>{try{const r=s.prepare(t),n=r.getColumnNames(),l=[];for(;r.step();){const c=r.getAsObject();l.push(c)}if(r.free(),l.length===0)throw new Error(`Query "${t}" returned no results.`);const i=Ys(n,l),d=new Blob([i],{type:"text/csv;charset=utf-8;"});Ee.saveAs(d,`${a}.csv`)}catch(r){throw console.error(`Failed to get CSV for query "${t}":`,r),r}},Xs=(t,s)=>{const r=ae(t)[s],n=`SELECT * FROM "${r}"`;re(n,t,r)},Js=t=>{const s=ae(t);for(const a of s)try{const r=`SELECT * FROM "${a}"`;re(r,t,a)}catch(r){throw console.error(`Failed to get CSV for table "${a}":`,r),r}},Zs=(t,s)=>{re(s,t,"custom_query")},ye=["Bytes","KB","MB","GB","TB"];function ea(t){let s=0;for(;t>=1024&&s<ye.length-1;)t/=1024,s++;return`${t.toFixed(2)} ${ye[s]}`}const b=Dt((t,s)=>({db:null,isLoading:!1,loadDatabaseBytes:async a=>{t({isLoading:!0});try{const r=await _s(a),n=ae(r),l=await Promise.all(n.map(async c=>{const u=r.exec(`SELECT COUNT(*) FROM "${c}"`),x=Number.parseInt(u[0].values[0][0],10),f=await Ws(r,c);return{name:c,count:x,schema:f}})),i=l.map(({name:c,count:u})=>({name:c,count:u})),d=l.reduce((c,{name:u,schema:x})=>(c[u]=x,c),{});t({db:r,tables:i,tableSchemas:d,isLoading:!1})}catch(r){throw t({isLoading:!1}),r}},tables:[],setTables:a=>t({tables:a}),selectedTable:"0",setSelectedTable:a=>t({selectedTable:a}),tableSchemas:{},customQuery:"",setIsCustomQuery:a=>t({isCustomQuery:a}),setCustomQuery:a=>t({customQuery:a}),isCustomQuery:!1,queryError:null,setQueryError:a=>t({queryError:a}),query:a=>{const{db:r}=s();return r?r.exec(a):(console.warn("Database is not loaded."),[])},rowPerPageOrAuto:"auto",setRowPerPageOrAuto:a=>t({rowPerPageOrAuto:a}),queryHistory:[],unShiftToQueryHistory:a=>t(r=>({queryHistory:[a,...r.queryHistory]})),expandPage:!1,setExpandPage:a=>t({expandPage:a}),dateFormatValue:"formatDateFormatted",setDateFormatValue:a=>t({dateFormatValue:a}),filters:{},setFilters:a=>t({filters:a}),appendToFilters:(a,r)=>t(n=>({filters:{...n.filters,[a]:r}})),filtersNeedClear:!1,setFiltersNeedClear:a=>t({filtersNeedClear:a}),totalRows:0,setTotalRows:a=>t({totalRows:a}),orderBy:{column:null,direction:"ASC"},setOrderBy:(a,r)=>t({orderBy:{column:a,direction:r}}),databaseData:{name:"database.db",size:0,sizeAsString:"0 Bytes"},setDatabaseData:a=>{t({databaseData:{...a,sizeAsString:ea(a.size)}})}}));function ta(t,s,a){const{db:r,setQueryError:n,setIsCustomQuery:l,query:i,unShiftToQueryHistory:d,customQuery:c,setCustomQuery:u,filters:x,totalRows:f,setTotalRows:p,orderBy:y,selectedTable:h,tables:j}=b(),[w,C]=o.useState([]),[S,I]=o.useState([]),[E,A]=o.useState(!0),M=o.useMemo(()=>Object.fromEntries(Object.entries(x).filter(([,N])=>N!=="")),[x]),T=o.useMemo(()=>Object.entries(M).map(([N,v])=>`LOWER(${N}) LIKE LOWER('%${v}%')`).join(" AND "),[M]);o.useEffect(()=>{if(!r||!t)return;(async()=>{A(!0);try{const v=`PRAGMA table_info("${t}");`,_=i(v)[0].values.map(k=>({name:k[1],type:k[2]})).map(k=>k.type.toUpperCase()==="BLOB"?`hex(${k.name}) as ${k.name}`:k.name).join(", "),W=`SELECT COUNT(*) as count FROM "${t}"${T?` WHERE ${T}`:""}`,K=i(W)[0].values[0][0];p(K);let L=`SELECT
	${_}
FROM "${t}"`;T&&(L+=`
WHERE ${T}`),y.column&&(L+=`
ORDER BY "${y.column}" ${y.direction}`),L+=`
LIMIT ${s} OFFSET ${a};`;const Rt=i(L),{data:Tt,columns:St}=be(Rt);I(St),C(Tt),n(null),u(L),d(L)}catch(v){v instanceof Error&&n(v.message)}finally{A(!1)}})()},[r,t,a,s,T,y,i,n,u,d,p]);const G=o.useCallback(()=>{if(c.trim()===""){n(null);return}A(!0);try{const N=j[Number.parseInt(h)].name,v=i(c.replace("@",`"${N}"`)),{data:q,columns:U}=be(v);I(U),C(q),l(!0),n(null)}catch(N){N instanceof Error&&n(N.message)}finally{A(!1)}},[c,i,n,l,j,h]);return{data:w,columns:S,customQuery:c,setCustomQuery:u,isQueryLoading:E,handleCustomQuery:G,totalRows:f}}function sa(t){const{setIsCustomQuery:s}=b(),[a,r]=o.useState(0);o.useEffect(()=>{r(0),s(!1)},[s]);const n=o.useMemo(()=>{if(t!=="auto")return t;const l=window.innerHeight,u=Math.min(2e3,40+l*.03),x=Math.max(1,Math.floor(l/u));return Math.min(Math.max(x,5),50)},[t]);return{page:a,setPage:r,rowsPerPage:n}}function m(...t){return ts(es(t))}const aa=Mt,Ye=o.forwardRef(({className:t,...s},a)=>e.jsx(Ft,{ref:a,className:m("border-b",t),...s}));Ye.displayName="AccordionItem";const Xe=o.forwardRef(({className:t,children:s,...a},r)=>e.jsx(Ot,{className:"flex",children:e.jsxs(ve,{ref:r,className:m("flex flex-1 items-center justify-between py-3 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...a,children:[s,e.jsx(te,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Xe.displayName=ve.displayName;const Je=o.forwardRef(({className:t,children:s,...a},r)=>e.jsx(Re,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:m("pb-4 pt-0",t),children:s})}));Je.displayName=Re.displayName;const oe=se("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),g=o.forwardRef(({className:t,variant:s,size:a,asChild:r=!1,...n},l)=>{const i=r?Pt:"button";return e.jsx(i,{className:m(oe({variant:s,size:a,className:t})),ref:l,...n})});g.displayName="Button";const ra=o.memo(ss);function Z({type:t,children:s,className:a=""}){let r,n;switch(t){case"error":r=e.jsx(os,{className:"mr-3 h-6 w-6 text-red-500"}),n="bg-red-100 text-red-800 border-l-4 border-red-500";break;case"loading":{r=e.jsx(ra,{className:"mr-3 h-6 w-6 animate-spin text-blue-500"}),n="bg-blue-100 text-blue-800 border-l-4 border-blue-500";break}case"success":r=e.jsx(rs,{className:"mr-3 h-6 w-6 text-green-500"}),n="bg-green-100 text-green-800 border-l-4 border-green-500";break;case"info":r=e.jsx(as,{className:"mr-3 h-6 w-6 text-yellow-500"}),n="bg-yellow-100 text-yellow-800 border-l-4 border-yellow-500";break;default:r=null,n=""}return e.jsxs("div",{className:`flex items-center rounded-lg p-4 shadow-md ${n} ${a}`,children:[r,e.jsx("span",{className:"font-medium",children:s})]})}const oa=qt,na=Ut,Ze=o.forwardRef(({className:t,align:s="center",sideOffset:a=4,...r},n)=>e.jsx(Bt,{children:e.jsx(Te,{ref:n,align:s,sideOffset:a,className:m("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));Ze.displayName=Te.displayName;function la(){const{selectedTable:t,customQuery:s,db:a}=b(),r=o.useMemo(()=>a&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx($,{onClick:()=>{try{Ks(a)}catch{D.error("Failed to download database")}},label:"Export as SQLite",title:"Download database as SQLite"}),e.jsx($,{onClick:()=>{try{Xs(a,Number.parseInt(t))}catch{D.error("Failed to export selected table as CSV")}},label:"Export selected table as CSV"}),e.jsx($,{onClick:()=>{try{Js(a)}catch{D.error("Failed to export all tables as CSV")}},label:"Export all tables as CSV"}),e.jsx($,{onClick:()=>{try{Zs(a,s)}catch{D.error("Failed to export custom query as CSV")}},label:"Export custom query as CSV",title:"Export the result of the custom query as CSV"})]}),[a,t,s]);return e.jsxs(oa,{children:[e.jsx(na,{asChild:!0,children:e.jsx(g,{title:"Open export options",children:e.jsx(ns,{className:"h-5 w-5"})})}),e.jsx(Ze,{align:"end",className:"w-80",children:r})]})}function $({onClick:t,label:s,className:a,title:r}){return e.jsx(g,{className:a,onClick:t,title:r??s,children:e.jsx("span",{className:"ml-2",children:s})})}const et=(t,s)=>localStorage.getItem(t)||s,tt=(t,s)=>localStorage.setItem(t,s),je=(t,s)=>{const[a,r]=o.useState(()=>et(t,s));return o.useEffect(()=>{tt(t,a)},[t,a]),[a,r]},ne=({shouldScaleBackground:t=!0,...s})=>o.useMemo(()=>e.jsx(R.Root,{shouldScaleBackground:t,...s}),[t,s]);ne.displayName="Drawer";const st=R.Trigger,ia=R.Portal,at=R.Close,rt=o.forwardRef(({className:t,...s},a)=>e.jsx(R.Overlay,{ref:a,className:m("fixed inset-0 z-50 bg-black/80",t),...s}));rt.displayName=R.Overlay.displayName;const le=o.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(ia,{children:[e.jsx(rt,{}),e.jsxs(R.Content,{ref:r,className:m("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...a,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),s]})]}));le.displayName="DrawerContent";const ie=({className:t,...s})=>e.jsx("div",{className:m("grid gap-1.5 p-4 text-center sm:text-left",t),...s});ie.displayName="DrawerHeader";const ce=({className:t,...s})=>e.jsx("div",{className:m("mt-auto flex flex-col gap-2 pb-4",t),...s});ce.displayName="DrawerFooter";const de=o.forwardRef(({className:t,...s},a)=>e.jsx(R.Title,{ref:a,className:m("text-lg font-semibold leading-none tracking-tight",t),...s}));de.displayName=R.Title.displayName;const me=o.forwardRef(({className:t,...s},a)=>e.jsx(R.Description,{ref:a,className:m("text-sm text-muted-foreground",t),...s}));me.displayName=R.Description.displayName;const X=t=>s=>{const a=We(s);return Ke(a)?Ps(a,t):s},ca=t=>{const s=We(t);return Ke(s)?Bs(s,{addSuffix:!0}):t},ee={formatDateRelative:{label:"Over 56 years ago",func:ca},formatDateFormatted:{label:"January 9th, 1968",func:X("MMMM do, yyyy")},formatDateLong:{label:"1968/09/01",func:X("yyyy/MM/dd")},formatDateShort:{label:"01/09/1968",func:X("MM/dd/yyyy")}},da=se("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ot=o.forwardRef(({className:t,...s},a)=>e.jsx(Se,{ref:a,className:m(da(),t),...s}));ot.displayName=Se.displayName;const ue=o.forwardRef(({className:t,...s},a)=>e.jsx(Ae,{className:m("grid gap-2",t),...s,ref:a}));ue.displayName=Ae.displayName;const nt=o.forwardRef(({className:t,...s},a)=>e.jsx(Le,{ref:a,className:m("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx($t,{className:"flex items-center justify-center",children:e.jsx(ls,{className:"h-2.5 w-2.5 fill-current text-current"})})}));nt.displayName=Le.displayName;const xe=o.forwardRef(({className:t,type:s,...a},r)=>e.jsx("input",{type:s,className:m("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...a}));xe.displayName="Input";function Q({value:t,label:s}){return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(nt,{value:t,id:`r-${t}`}),e.jsx(ot,{htmlFor:`r-${t}`,children:s})]})}function ma({rowsPerPage:t,onRowsPerPageChange:s}){const a=t==="auto";return e.jsxs("div",{className:"flex h-full grow flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:"Rows Per Page"})]}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1 rounded border bg-gray-100/50 p-2 dark:bg-gray-700/50",children:[e.jsx(xe,{id:"rowsPerPage",value:a?"":t,onChange:r=>s(r.target.value),placeholder:"Number of rows",type:"number",className:"w-full",autoFocus:!1}),e.jsx(g,{variant:"outline",onClick:()=>s("auto"),className:"w-full whitespace-nowrap",children:"Auto Calculate"})]})]})}function ua({dateFormatValue:t,onDateFormatChange:s}){return e.jsxs("div",{className:"flex h-full grow flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:"Date Format"})]}),e.jsx("div",{className:"h-full rounded border bg-gray-100/50 p-2 dark:bg-gray-700/50",children:e.jsxs(ue,{className:"flex h-full flex-col gap-2",name:"dateType",value:t,onValueChange:s,children:[e.jsx(Q,{value:"default",label:"Default"}),Object.entries(ee).map(([a,{label:r}])=>e.jsx(Q,{value:a,label:r},a))]})})]})}function xa({themeColor:t,onThemeColorChange:s,themeColors:a}){return e.jsxs("div",{className:"flex grow flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:"Theme Color"})]}),e.jsxs(ue,{className:"flex flex-col gap-2 rounded border bg-gray-100/50 p-2 dark:bg-gray-700/50",name:"themeColor",value:t,onValueChange:s,children:[e.jsx(Q,{value:"default",label:"Default"}),a.map(r=>e.jsx(Q,{value:r,label:r[0].toUpperCase()+r.slice(1)},r))]})]})}const fa="rowsPerPage",Ne="dateFormat",pa="theme-color",we=["nord","zinc"],ha=o.memo(function(){const{setRowPerPageOrAuto:s,setIsCustomQuery:a,dateFormatValue:r,setDateFormatValue:n}=b(),[l,i]=je(fa,"auto"),[d,c]=je(pa,"default"),u=l==="auto";o.useEffect(()=>{s(u?"auto":Number(l))},[l,s,u]),o.useEffect(()=>{n(et(Ne,"default"))},[n]),o.useEffect(()=>{var h;for(const j of we)(h=document.body)==null||h.classList.toggle(j,j===d)},[d]);const x=o.useCallback(h=>{a(!1),h==="auto"||Number(h)>0?i(h):D.error("Please provide a positive number of rows per page or set it to auto.")},[a,i]),f=o.useCallback(h=>{n(h),tt(Ne,h)},[n]),p=o.useCallback(h=>{c(h)},[c]),y=o.useMemo(()=>e.jsx(_e,{className:"h-5 w-5"}),[]);return e.jsxs(ne,{children:[e.jsx(st,{asChild:!0,children:e.jsx(g,{className:"grow",title:"Open settings drawer",children:y})}),e.jsxs(le,{children:[e.jsxs(ie,{className:"hidden",children:[e.jsx(de,{children:"Settings"}),e.jsx(me,{children:"Change settings."})]}),e.jsxs("div",{className:"mx-auto flex w-full max-w-sm flex-col gap-3 px-4 md:px-0",children:[e.jsx(ma,{rowsPerPage:l,onRowsPerPageChange:x}),e.jsx(xa,{themeColor:d,onThemeColorChange:p,themeColors:we}),e.jsx(ua,{dateFormatValue:r,onDateFormatChange:f}),e.jsx(ce,{children:e.jsx(at,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Cancel"})})})]})]})]},"settings-drawer")}),ga=o.memo(ha),fe=o.forwardRef(({className:t,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:m("w-full caption-bottom text-sm",t),...s})}));fe.displayName="Table";const pe=o.forwardRef(({className:t,...s},a)=>e.jsx("thead",{ref:a,className:m("[&_tr]:border-b",t),...s}));pe.displayName="TableHeader";const he=o.forwardRef(({className:t,...s},a)=>e.jsx("tbody",{ref:a,className:m("[&_tr:last-child]:border-0",t),...s}));he.displayName="TableBody";const ba=o.forwardRef(({className:t,...s},a)=>e.jsx("tfoot",{ref:a,className:m("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s}));ba.displayName="TableFooter";const B=o.forwardRef(({className:t,...s},a)=>e.jsx("tr",{ref:a,className:m("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s}));B.displayName="TableRow";const z=o.forwardRef(({className:t,...s},a)=>e.jsx("th",{ref:a,className:m("h-12 min-w-[150px] px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s}));z.displayName="TableHead";const H=o.memo(o.forwardRef(({className:t,children:s,...a},r)=>e.jsx("td",{ref:r,className:m("max-w-[200px] overflow-hidden truncate text-ellipsis whitespace-nowrap p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a,children:s})));H.displayName="TableCell";const ya=o.forwardRef(({className:t,...s},a)=>e.jsx("caption",{ref:a,className:m("mt-4 text-sm text-muted-foreground",t),...s}));ya.displayName="TableCaption";const ja={DATE:/DATE|TIMESTAMP/i,BLOB:/^BLOB$/i,TEXT:/CHAR|TEXT|CLOB|VARCHAR/i,INTEGER:/INT/i,REAL:/REAL|FLOAT|DOUBLE|DECIMAL/i,NUMERIC:/NUMERIC/i,BOOLEAN:/BOOL/i},F=(t,s)=>ja[s].test(t),lt=t=>F(t,"DATE"),Na=t=>F(t,"BLOB"),wa=t=>F(t,"TEXT"),Ca=t=>F(t,"INTEGER"),Ea=t=>F(t,"REAL"),va=t=>F(t,"NUMERIC"),Ra=t=>F(t,"BOOLEAN"),Ta=t=>Ca(t)||Ea(t)||va(t),Sa=o.memo(({columnSchema:t})=>e.jsxs(e.Fragment,{children:[(t==null?void 0:t.isPrimaryKey)&&e.jsx("p",{className:"text-sm font-semibold text-yellow-600",children:"(Primary)"}),(t==null?void 0:t.isForeignKey)&&e.jsx("p",{className:"text-sm font-semibold text-purple-600",children:"(Foreign)"})]})),it=o.memo(({columnSchema:t})=>{const{type:s,isPrimaryKey:a,isForeignKey:r}=t;if(a)return e.jsx(cs,{className:"h-4 w-4 text-yellow-500"});if(r)return e.jsx(ds,{className:"h-4 w-4 text-purple-500"});if(s){if(Na(s))return e.jsx(ms,{className:"h-4 w-4 text-green-500"});if(lt(s))return e.jsx(Ve,{className:"h-4 w-4 text-blue-500"});if(wa(s))return e.jsx(us,{className:"h-4 w-4 text-indigo-500"});if(Ta(s))return e.jsx(xs,{className:"h-4 w-4 text-red-500"});if(Ra(s))return e.jsx(fs,{className:"h-4 w-4 text-pink-500"})}return e.jsx(ps,{className:"h-4 w-4 text-gray-500"})});function Aa(){const{tableSchemas:t}=b(),s=o.useMemo(()=>Object.keys(t).map(a=>e.jsxs("section",{children:[e.jsx("h2",{className:"rounded-t-lg bg-gray-100 p-2 dark:bg-gray-700",children:a}),e.jsx("div",{className:"overflow-hidden rounded-b-lg border border-gray-200 dark:border dark:border-gray-700",children:e.jsxs(fe,{children:[e.jsx(pe,{children:e.jsxs(B,{children:[e.jsx(z,{children:"Column"}),e.jsx(z,{children:"Type"})]})}),e.jsx(he,{children:Object.entries(t[a]).map(([r,n])=>e.jsxs(B,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex cursor-pointer items-center space-x-1",children:[e.jsx("span",{className:"max-w-[200px] overflow-hidden truncate text-ellipsis whitespace-nowrap",children:r}),e.jsx(it,{columnSchema:n})]})}),e.jsx(H,{children:n.type||"Unknown"})]},r))})]})})]},a)),[t]);return e.jsxs(ne,{children:[e.jsx(st,{asChild:!0,children:e.jsx(g,{className:"grow",title:"Open table schema drawer",children:e.jsx(hs,{className:"h-5 w-5"})})}),e.jsxs(le,{children:[e.jsxs(ie,{className:"hidden",children:[e.jsx(de,{children:"Settings"}),e.jsx(me,{children:"Change settings."})]}),e.jsxs("section",{className:"flex grow flex-col gap-2 px-4 md:px-0",children:[e.jsx("div",{className:"mx-auto flex max-h-[500px] w-full max-w-xl flex-col gap-3 overflow-y-auto p-2",children:s}),e.jsx("div",{className:"mx-auto w-full max-w-sm",children:e.jsx(ce,{children:e.jsx(at,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Cancel"})})})})]})]})]},"table-schema-drawer")}const La=o.memo(Aa),J="theme-mode",Ce="animate-circular-reveal",Da=o.memo(function(){const[s,a]=o.useState(()=>{const i=localStorage.getItem(J),d=window.matchMedia("(prefers-color-scheme: dark)").matches;return i||(d?"dark":"light")}),r=o.useCallback(i=>{a(i),document.body.classList.remove("light","dark"),document.body.classList.add(i),localStorage.setItem(J,i),document.body.classList.add(Ce),setTimeout(()=>{document.body.classList.remove(Ce)},500)},[]);o.useEffect(()=>{const i=c=>{localStorage.getItem(J)||r(c.matches?"dark":"light")},d=window.matchMedia("(prefers-color-scheme: dark)");return d.addEventListener("change",i),r(s),()=>{d.removeEventListener("change",i)}},[r,s]);const n=o.useCallback(()=>{r(s==="light"?"dark":"light")},[s,r]);return o.useMemo(()=>e.jsx(g,{className:"relative grow",onClick:n,title:s==="dark"?"Enable light mode":"Enable dark mode",children:s==="dark"?e.jsx(gs,{className:"h-5 w-5"}):e.jsx(bs,{className:"h-5 w-5"})}),[s,n])}),ct=o.memo(Da),Ia=o.memo(ys),ka=o.memo(js);function Fa({page:t,setPage:s,rowsPerPage:a}){const{totalRows:r}=b(),n=o.useMemo(()=>Math.ceil(r/a),[r,a]),l=o.useMemo(()=>Math.ceil(t/a)+1,[t,a]),i=l<n,d=l>1,c=o.useCallback(()=>{i&&s(x=>x+a)},[i,a,s]),u=o.useCallback(()=>{d&&s(x=>x-a)},[d,a,s]);return e.jsx("section",{className:"fixed bottom-2 left-1/2 z-10 w-[270px] -translate-x-1/2 transform",children:e.jsxs("div",{className:"flex justify-between gap-2 rounded border bg-secondary p-[6px]",children:[e.jsx(g,{onClick:u,title:"Previous page",disabled:!d,children:e.jsx(Ia,{className:"h-4 w-4"})}),e.jsxs("span",{className:"flex items-center justify-center text-sm",children:["Page ",l," of ",n]}),e.jsx(g,{onClick:c,title:"Next page",disabled:!i,children:e.jsx(ka,{className:"h-4 w-4"})})]})})}const Oa=_t,Ma=Wt,Pa=Kt,Ba=o.memo(te),dt=o.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(De,{ref:r,className:m("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(Qt,{asChild:!0,children:e.jsx(Ba,{className:"h-4 w-4 opacity-50"})})]}));dt.displayName=De.displayName;const mt=o.forwardRef(({className:t,...s},a)=>e.jsx(Ie,{ref:a,className:m("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ns,{className:"h-4 w-4"})}));mt.displayName=Ie.displayName;const ut=o.forwardRef(({className:t,...s},a)=>e.jsx(ke,{ref:a,className:m("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(te,{className:"h-4 w-4"})}));ut.displayName=ke.displayName;const xt=o.forwardRef(({className:t,children:s,position:a="popper",...r},n)=>e.jsx(zt,{children:e.jsxs(Fe,{ref:n,className:m("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...r,children:[e.jsx(mt,{}),e.jsx(Ht,{className:m("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(ut,{})]})}));xt.displayName=Fe.displayName;const ft=o.forwardRef(({className:t,...s},a)=>e.jsx(Oe,{ref:a,className:m("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));ft.displayName=Oe.displayName;const pt=o.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(Me,{ref:r,className:m("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Vt,{children:e.jsx(ws,{className:"h-4 w-4"})})}),e.jsx(Gt,{children:s})]}));pt.displayName=Me.displayName;const qa=o.forwardRef(({className:t,...s},a)=>e.jsx(Pe,{ref:a,className:m("-mx-1 my-1 h-px bg-muted",t),...s}));qa.displayName=Pe.displayName;const Ua=se("inline-flex items-center rounded border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function V({className:t,variant:s,...a}){return e.jsx("div",{className:m(Ua({variant:s}),t),...a,children:e.jsx("span",{className:"w-full",children:a.children})})}function $a(){const{tables:t,selectedTable:s,setSelectedTable:a,setIsCustomQuery:r}=b(),n=o.useMemo(()=>{var c;const d=Number.parseInt(s);return Number.isNaN(d)?0:((c=t[d])==null?void 0:c.count)||0},[t,s]),l=o.useMemo(()=>t.map((d,c)=>e.jsx(pt,{value:`${c}`,children:d.name[0].toUpperCase()+d.name.slice(1)},d.name)),[t]);function i(d){r(!1),a(d)}return e.jsxs("section",{className:"flex grow items-center justify-center gap-1",children:[e.jsxs(Oa,{value:s,onValueChange:i,children:[e.jsx(dt,{className:"grow",children:e.jsx(Pa,{placeholder:"Select a table"})}),e.jsx(xt,{children:e.jsxs(Ma,{children:[e.jsx(ft,{children:"Tables"}),l]})})]}),e.jsx(V,{title:"Rows",className:"hidden min-w-[100px] grow bg-background py-2 text-center text-sm md:block md:min-w-[200px]",variant:"outline",children:e.jsx("span",{className:"w-full text-center",children:n})})]})}const Qa=o.memo($a),ht=Yt,gt=Xt,ge=o.memo(o.forwardRef(({className:t,align:s="start",side:a="bottom",sideOffset:r=4,...n},l)=>e.jsx(Be,{ref:l,align:s,side:a,sideOffset:r,className:m("z-50 w-64 text-balance break-words rounded-md border p-4 text-popover-foreground shadow-md outline-none","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[side=bottom]:slide-in-from-top-1","data-[side=left]:slide-in-from-right-1","data-[side=right]:slide-in-from-left-1","data-[side=top]:slide-in-from-bottom-1","bg-gray-100 dark:bg-gray-700",t),...n})));ge.displayName=Be.displayName;function za({columnName:t}){const{appendToFilters:s,selectedTable:a,filtersNeedClear:r,setFiltersNeedClear:n}=b(),[l,i]=o.useState("");o.useEffect(()=>{i("")},[a]),o.useEffect(()=>{r&&(i(""),n(!1))},[r,n]);const d=o.useCallback(c=>{const u=c.target.value;i(u),s(t,u)},[s,t]);return e.jsx(xe,{value:l,onChange:d,className:"mt-[2px] max-h-7 w-full text-xs",placeholder:"Filter"})}function Ha({columnName:t}){const{orderBy:s,setOrderBy:a}=b(),r=o.useCallback(()=>{s.column===t?s.direction==="ASC"?a(t,"DESC"):s.direction==="DESC"&&a(null,"ASC"):a(t,"ASC")},[s,t,a]);return e.jsx("div",{onClick:r,onKeyUp:r,className:"flex items-center",children:s.column===t?s.direction==="ASC"?e.jsx("button",{title:"Descending",type:"button","aria-label":"Sort Descending",children:e.jsx(Cs,{className:"h-4 w-4"})}):e.jsx("button",{title:"Ascending",type:"button","aria-label":"Sort Ascending",children:e.jsx(Es,{className:"h-4 w-4"})}):e.jsx("button",{title:"Sort column",type:"button","aria-label":"Sort Column",children:e.jsx(vs,{className:"h-4 w-4"})})})}const Va=o.memo(({columnName:t,columnSchema:s})=>e.jsxs(z,{className:"bg-gray-100 py-2 dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ha,{columnName:t}),e.jsxs(ht,{children:[e.jsx(gt,{asChild:!0,children:e.jsxs("div",{className:"flex cursor-pointer items-center space-x-1",children:[e.jsx("span",{className:"max-w-[200px] overflow-hidden truncate text-ellipsis whitespace-nowrap",children:t}),s&&e.jsx(it,{columnSchema:s})]})}),e.jsxs(ge,{className:"w-64",children:[e.jsxs("div",{className:"mb-1 flex items-center space-x-1",children:[e.jsx("p",{className:"text-sm font-medium",children:t}),e.jsx(Sa,{columnSchema:s})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-full self-start text-center text-xs font-semibold",children:(s==null?void 0:s.type)||"Unknown"}),(s==null?void 0:s.nullable)&&e.jsx(V,{className:"w-full self-start text-center text-xs font-semibold",children:"NULLABLE"})]})]})]})]}),e.jsx(za,{columnName:t})]})),Ga=t=>{const s=new Uint8Array(t.match(/.{1,2}/g).map(r=>Number.parseInt(r,16))),a=new Blob([s],{type:"image/jpeg"});return URL.createObjectURL(a)},_a=o.memo(({value:t,dataType:s})=>{const{dateFormatValue:a}=b(),r=(s==null?void 0:s.toUpperCase())==="BLOB",n=o.useMemo(()=>{if(!t)return e.jsx("span",{className:"italic text-gray-400",children:"NULL"});if(s&&lt(s))return ee[a]?ee[a].func(t):t;const l=typeof t=="string"?t:String(t);return l.length>40?`${l.slice(0,40)}...`:l},[t,s,a]);return e.jsx(H,{className:"px-5 py-[11px] text-sm",children:e.jsxs(ht,{children:[e.jsx(gt,{asChild:!0,children:e.jsx("span",{className:"cursor-pointer hover:underline",children:r?e.jsx("span",{className:"italic opacity-40",children:"BLOB"}):n})}),e.jsx(ge,{side:"bottom",align:"start",children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[r&&typeof t=="string"?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Ga(t),alt:"BLOB content",className:"flex max-h-40 flex-col items-center justify-center gap-2 rounded object-contain",onError:l=>{l.currentTarget.style.display="none"}}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Blob length: ",t.length]})]}):e.jsx("span",{className:"max-w-full break-words",children:n}),e.jsx(V,{className:"w-full self-start text-center text-xs font-semibold",children:s||"Unknown"})]})})]})})});function Wa({data:t,columns:s,tableName:a,tableSchemas:r}){const{filters:n,setFiltersNeedClear:l,setFilters:i}=b(),d=o.useMemo(()=>e.jsx(pe,{children:e.jsx(B,{children:s.map((x,f)=>e.jsx(Va,{columnName:x,columnSchema:r[a][x]},f))})}),[s,r,a]),c=o.useMemo(()=>e.jsx(he,{children:t.map((x,f)=>e.jsx(B,{children:s.map((p,y)=>{var h;return e.jsx(_a,{value:x[p],dataType:(h=r[a][p])==null?void 0:h.type},y)})},f))}),[t,s,r,a]),u=o.useCallback(()=>{l(!0),i({})},[l,i]);return e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs(fe,{children:[d,t.length>0&&c]}),t.length===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full p-4 text-center font-medium",children:["No data available for ",a]}),Object.keys(n).length>0&&e.jsx(g,{className:"w-full rounded-none",variant:"outline",onClick:u,children:"Clear filters"})]})]})}function Ka(){const[t,s]=o.useState(()=>document.body.classList.contains("dark"));return o.useEffect(()=>{const a=new MutationObserver(()=>{s(document.body.classList.contains("dark"))});return a.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>a.disconnect()},[]),t}const Ya=["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"];function Xa(){const{customQuery:t,setCustomQuery:s,tables:a,tableSchemas:r}=b(),n=Ka(),l=o.useCallback(c=>{const u=c.matchBefore(/\w*/);if(!u||u.from===u.to&&!c.explicit)return null;const x=[];for(const p of Object.values(r))x.push(...Object.keys(p));const f=[...Ya.map(p=>({label:p,type:"keyword"})),...a.map(p=>({label:p.name,type:"table"})),...x.map(p=>({label:p,type:"column"}))];return{from:u.from,to:u.to,options:f}},[a,r]),i=o.useCallback(c=>{s(c)},[s]),d=o.useMemo(()=>[qs,Us(),$s({override:[l]})],[l]);return e.jsx(Qs,{value:t,height:"126px",extensions:d,onChange:i,className:"rounded-md border",theme:n?zs:"light"})}const Ja=o.memo(Qa),Za=o.memo(la);function er(){const{tables:t,selectedTable:s,tableSchemas:a,queryError:r,setQueryError:n,rowPerPageOrAuto:l,isCustomQuery:i,customQuery:d,setIsCustomQuery:c,setCustomQuery:u,expandPage:x,setExpandPage:f,filters:p,setFilters:y,databaseData:h}=b(),{page:j,setPage:w,rowsPerPage:C}=sa(l),S=o.useMemo(()=>{var P;return(P=t[Number.parseInt(s)])==null?void 0:P.name},[t,s]),{data:I,columns:E,isQueryLoading:A,handleCustomQuery:M}=ta(S,C,j),[T,G]=o.useState([]);o.useEffect(()=>{E.length>0&&G(E)},[E]);const N=o.useCallback(()=>{n(null),u(""),c(!1)},[c,n,u]),v=o.useCallback(()=>{function P(L){try{return kt(L,{language:"sqlite",useTabs:!1,keywordCase:"upper",tabWidth:2,expressionWidth:100,linesBetweenQueries:1})}catch{return L}}const K=P(d);u(K)},[d,u]);o.useEffect(()=>{w(0),y({})},[s]),o.useEffect(()=>{w(0)},[p]);const q=o.useMemo(()=>e.jsx(aa,{type:"single",collapsible:!0,className:"w-full rounded-lg bg-background px-3",children:e.jsxs(Ye,{value:"item-1",children:[e.jsx(Xe,{className:"text-xs",children:"Execute Query"}),e.jsxs(Je,{className:"flex flex-col gap-[6px]",children:[e.jsx("div",{className:"flex-grow",children:e.jsx(Xa,{})}),e.jsxs("div",{className:"flex flex-row gap-1 md:gap-2",children:[e.jsx(g,{className:"grow",variant:"secondary",onClick:M,title:"Run custom query",children:e.jsx(Rs,{className:"h-5 w-5"})}),e.jsx(g,{className:"grow opacity-80",variant:"secondary",onClick:N,title:"Remove query",children:e.jsx(Ts,{className:"h-5 w-5"})}),e.jsx(g,{className:"grow opacity-80",variant:"secondary",onClick:v,title:"Format SQL",children:e.jsx(Ge,{className:"h-5 w-5"})})]})]})]})}),[M,N,v,j,T]),U=o.useMemo(()=>A?e.jsxs(Z,{type:"loading",children:["Loading ",S]}):e.jsx("div",{className:"mb-[40px] overflow-hidden rounded-lg border border-gray-200 dark:border dark:border-gray-700",children:e.jsx(Wa,{data:I,columns:T.length>0?T:E,tableName:S,tableSchemas:a})}),[A,I,E,S,a,T]),_=o.useMemo(()=>e.jsx(Za,{}),[]),W=o.useMemo(()=>x?e.jsx(Ss,{className:"h-5 w-5"}):e.jsx(As,{className:"h-5 w-5"}),[x]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-3 pb-8",children:[e.jsxs("section",{className:"flex w-full items-center justify-between gap-4 rounded-lg bg-gray-100 p-4 text-sm shadow-sm dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"max-w-[160px] overflow-hidden text-ellipsis whitespace-nowrap font-medium",children:h.name}),e.jsxs("div",{className:"hidden text-gray-500 dark:text-gray-400 sm:block",children:["(",h.sizeAsString,")"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ct,{}),e.jsx(ga,{})]})]}),e.jsxs("section",{className:"rounded-lg bg-gray-100 p-4 shadow-sm dark:bg-gray-700",children:[e.jsxs("div",{className:"mb-[5px] flex items-center justify-between gap-[6px] pb-[3px]",children:[e.jsx(Ja,{}),e.jsxs("div",{className:"g-1 flex items-center justify-center gap-1",children:[_,e.jsx(g,{className:"hidden expand:block",onClick:()=>f(!x),title:"Toggle page size",children:W}),e.jsx(La,{})]})]}),q,r&&e.jsx("p",{className:"mt-2 text-center text-sm text-red-500 dark:text-red-400",children:r})]}),U,!i&&e.jsx(Fa,{page:j,setPage:w,rowsPerPage:C})]})})}const tr=o.memo(er),sr={"application/vnd.sqlite3":[".sqlite",".sqlite3",".db",".sqlitedb"],"application/x-sqlite3":[".sqlite",".sqlite3",".db",".sqlitedb"],"application/sqlite3":[".sqlite",".sqlite3",".db",".sqlitedb"],"application/octet-stream":[".sqlite",".sqlite3",".db",".sqlitedb"],"application/sql":[".sql"],"application/x-sql":[".sql"],"text/x-sql":[".sql"],"text/sql":[".sql"],"text/x-sqlite3":[".sql",".sqlite",".sqlite3",".db",".sqlitedb"],"text/x-sqlite":[".sql",".sqlite",".sqlite3",".db",".sqlitedb"],"text/sqlite":[".sql",".sqlite",".sqlite3",".db",".sqlitedb"],"text/x-sqlite3-dump":[".sql"],"text/x-sqlite-dump":[".sql"],"text/sqlite-dump":[".sql"]};function ar(){const{loadDatabaseBytes:t,setDatabaseData:s}=b(),[a,r]=o.useState([]),n=o.useCallback(async(u,x)=>{if(x.length>0){const f=x.flatMap(p=>p.errors);r(f);return}if(u.length>0)try{const f=u[0],p=new Uint8Array(await f.arrayBuffer());s({name:f.name,size:f.size}),await t(p)}catch(f){return f instanceof Error?D(f.message,{position:"bottom-right"}):D("Failed to load database",{position:"bottom-right"})}},[t,s]),{getRootProps:l,getInputProps:i,isDragActive:d}=Hs({onDrop:n,multiple:!1,accept:sr}),c=o.useMemo(()=>e.jsx("div",{className:"flex w-full items-center justify-between gap-2",children:e.jsxs("div",{...l(),className:`flex w-full grow transform cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed bg-gray-100/50 p-6 transition-colors duration-300 ease-in-out hover:bg-secondary dark:bg-gray-700/50 ${d?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-primary py-12 dark:border-gray-700"}`,children:[e.jsx("input",{id:"file-upload",...i()}),e.jsx("label",{htmlFor:"file-upload",className:"sr-only",children:"Upload SQLite File"}),e.jsxs("div",{className:"text-center text-sm md:text-base",children:[e.jsx("span",{className:"hidden sm:block lg:text-lg",children:"Drag and drop file here, or click to select one"}),e.jsx("div",{className:"block sm:hidden",children:e.jsx("span",{className:"text-lg font-medium",children:"Click to select a SQLite file"})})]})]})}),[l,i,d]);return e.jsxs("section",{className:"mx-auto w-full",children:[c,e.jsx(rr,{errors:a})]})}const rr=o.memo(({errors:t})=>(o.useEffect(()=>{if(t)for(const s of t)D(s.message,{position:"bottom-right"})},[t]),null)),or=o.memo(ar);function nr(){return e.jsx("header",{className:"rounded bg-gradient-to-r shadow-md dark:from-gray-800 dark:to-indigo-900",children:e.jsx("div",{className:"mx-auto max-w-4xl px-4 py-8 sm:py-12",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold sm:text-3xl",children:"SQLite Viewer"}),e.jsx("p",{className:"max-w-md text-sm sm:text-base",children:"Explore and analyze your SQLite databases directly in your browser"})]})})})}function lr(){return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"rounded bg-gradient-to-r py-6 shadow-md dark:from-gray-800 dark:to-indigo-900 md:py-10",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(O,{icon:Ls,title:"Browser Based",description:"No installation required. Access and analyze your SQLite databases directly in your web browser."}),e.jsx(O,{icon:Ds,title:"Lightning Fast",description:"Powered by WebAssembly (WASM) for near-native performance, even with large databases."}),e.jsx(O,{icon:Is,title:"100% Secure",description:"Your data never leaves your device. All processing happens client-side, ensuring complete privacy."}),e.jsx(O,{icon:_e,title:"Customizable Interface",description:"Different themes and settings. Adjust the look and feel of your interface to suit your preferences and workflow."}),e.jsx(O,{icon:ks,title:"Offline Capable",description:"Work on your databases without an internet connection. Perfect for sensitive data or remote work."}),e.jsx(O,{icon:Fs,title:"PWA Support",description:"Install the app on your desktop or mobile device for a genuine native experience. Enjoy robust offline functionality."})]})})})}),e.jsx("div",{className:"pb-[72px] md:pb-0"})]})}function O({icon:t,title:s,description:a}){return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(t,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:s}),e.jsx("p",{className:"mt-1 text-sm",children:a})]})]})}const ir=o.memo(lr),cr=Jt,dr=Zt,bt=o.forwardRef(({className:t,...s},a)=>e.jsx(qe,{className:m("fixed inset-0 z-50 bg-black/70 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));bt.displayName=qe.displayName;const yt=o.forwardRef(({className:t,...s},a)=>e.jsxs(dr,{children:[e.jsx(bt,{}),e.jsx(Ue,{ref:a,className:m("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));yt.displayName=Ue.displayName;const jt=({className:t,...s})=>e.jsx("div",{className:m("flex flex-col space-y-2",t),...s});jt.displayName="AlertDialogHeader";const Nt=({className:t,...s})=>e.jsx("div",{className:m("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Nt.displayName="AlertDialogFooter";const wt=o.forwardRef(({className:t,...s},a)=>e.jsx($e,{ref:a,className:m("text-lg font-semibold",t),...s}));wt.displayName=$e.displayName;const Ct=o.forwardRef(({className:t,...s},a)=>e.jsx(Qe,{ref:a,className:m("text-sm text-muted-foreground",t),...s}));Ct.displayName=Qe.displayName;const Et=o.forwardRef(({className:t,...s},a)=>e.jsx(ze,{ref:a,className:m(oe(),t),...s}));Et.displayName=ze.displayName;const vt=o.forwardRef(({className:t,...s},a)=>e.jsx(He,{ref:a,className:m(oe({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));vt.displayName=He.displayName;const mr=o.memo(yt);function ur({showDialog:t,setShowDialog:s,onConfirm:a}){const r=o.useCallback(()=>{s(!1)},[s]);return e.jsx(cr,{open:t,onOpenChange:s,children:e.jsxs(mr,{children:[e.jsxs(jt,{children:[e.jsx(wt,{children:"Use Proxy to Load Database?"}),e.jsx(Ct,{children:"We couldn't load the database from the provided URL due to CORS restrictions. Would you like to try using a proxy?"})]}),e.jsx("div",{className:"font-semibold text-yellow-600 md:text-left",children:"Warning: Using the proxy will route your database traffic through cors.eu.org."}),e.jsxs(Nt,{children:[e.jsx(vt,{onClick:r,children:"Cancel"}),e.jsx(Et,{onClick:a,children:"Use Proxy"})]})]})})}const xr=/^(https?:\/\/(?:www\.)?[a-zA-Z0-9-]{1,256}\.[a-zA-Z]{2,6}(?:\/[^\s]*)?)$/i,fr="https://cors.eu.org";function pr(){const{db:t,isLoading:s,loadDatabaseBytes:a,setDatabaseData:r}=b(),[n,l]=o.useState(null),[i,d]=o.useState(!1),[c,u]=o.useState(null),[x,f]=o.useState(!1),p=o.useRef(!1),y=o.useCallback(async(j,w=!1)=>{if(!xr.test(j)){l("Invalid URL");return}try{f(!0);const C=w?`${fr}/${encodeURIComponent(j)}`:j,S=await fetch(C);if(!S.ok)throw new Error("URL not found or invalid");const I=await S.blob(),E=new File([I],"database.sqlite"),A=new Uint8Array(await E.arrayBuffer());r({name:E.name,size:E.size}),await a(A),l(null)}catch(C){w?l(`Error while fetching, ${C instanceof Error?C.message:String(C)}`):(u(j),d(!0))}finally{f(!1)}},[a,r]);o.useEffect(()=>{if(p.current)return;const w=new URLSearchParams(window.location.search).get("url");w&&(y(decodeURIComponent(w)),p.current=!0)},[y]);const h=o.useCallback(()=>{c&&(y(c,!0),d(!1))},[c,y]);return s||x?e.jsxs(Z,{type:"loading",children:[x?"Fetching":"Loading"," SQLite file"]}):n&&!t?e.jsx(Z,{type:"error",children:n}):e.jsx(e.Fragment,{children:i&&e.jsx(ur,{showDialog:i,setShowDialog:d,onConfirm:h},"proxy-message")})}const hr=o.memo(function(){return e.jsx("footer",{className:"fixed bottom-0 left-0 right-0 border-t bg-background shadow-md",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between py-4 md:py-6",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sms hidden sm:block",children:"No file will be uploaded to server. Using JavaScript, sql.js"}),e.jsx("p",{className:"text-sm sm:hidden",children:"No file uploads to server."})]}),e.jsxs("a",{href:"https://github.com/vwh/sqlite-viewer",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-blue-500",title:"Star on GitHub",children:[e.jsx(Os,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium hover:underline",children:"Star us on GitHub"})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ct,{})})]})})})}),gr=o.memo(hr),br=o.memo(tr),yr=o.memo(or),jr=o.memo(pr);function Nr(){const{db:t,expandPage:s}=b();return e.jsx("main",{className:`mx-auto flex h-screen flex-col ${t?"gap-3":"gap-4"} p-4 ${s?"w-full":"container"}`,children:t?e.jsx(br,{}):e.jsxs(e.Fragment,{children:[e.jsx(nr,{})," ",e.jsx(yr,{})," ",e.jsx(jr,{}),e.jsx(ir,{}),e.jsx(gr,{})]})})}const wr=({...t})=>e.jsx(Ms,{className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-gray-100 p-2 dark:group-[.toaster]:bg-gray-700 text-lg p-4 group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t});Lt.createRoot(document.getElementById("root")).render(e.jsxs(At.StrictMode,{children:[e.jsx(Nr,{}),e.jsx(wr,{})]}));
