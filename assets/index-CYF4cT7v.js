import{j as e,r as n,R as de}from"./react-Cbey2zwD.js";import{c as Xe}from"./react-dom-Bahpv_eZ.js";import{z as Ye}from"./next-themes-BnU968HI.js";import{T as Je,t as Y}from"./sonner-BNb8UgIc.js";import{c as me}from"./zustand-DQwkjSPQ.js";import{R as Ze,T as et,C as tt,L as st,S as at,a as nt,b as rt,c as lt,I as ot,V as it,P as ct,d as dt,e as mt,f as ut,g as xt,h as ht,i as pt,j as ft,k as bt,l as gt,m as jt,n as vt}from"./@radix-ui-DQJwUSQx.js";import{c as Nt}from"./clsx-B-dksMZM.js";import{t as wt}from"./tailwind-merge-AdmevC4f.js";import{c as St}from"./class-variance-authority-Dp3B9jqt.js";import{S as Ct,M as yt,D as ye,a as Tt,K as Et,b as It,C as zt,c as Rt,T as Lt,H as Pt,d as kt,e as Dt,f as se,g as Te,h as Ee,i as At,j as Mt,k as Ot,l as Bt,G as Ft,m as Ut,n as Ht,F as ue,L as Ie,P as J,o as W,p as Ce,q as ze,r as Vt,A as Gt,s as Qt,t as _t,u as $t,v as Wt,w as xe,x as Kt}from"./lucide-react-DULzjv9a.js";import{P as qt,a as Xt,b as Yt}from"./react-resizable-panels-C-QGln0U.js";import{R as Jt,d as Zt}from"./@uiw-HyYrqtSm.js";import{G as es,I as ts,r as ss}from"./@codemirror-BjKk2IdN.js";import"./scheduler-BNqrtbQi.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-Chf2DkHF.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-D6sioXcm.js";import"./react-style-singleton-CUIzRnLb.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-2cM-wPzK.js";import"./use-callback-ref-D81gfTH3.js";import"./@floating-ui-syThYpGD.js";import"./@babel-Cv5OCJ0e.js";import"./@lezer-E7PapBHi.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const as=({...t})=>{const{theme:s="system"}=Ye();return e.jsx(Je,{theme:s,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})},ns={theme:"system",setTheme:()=>null},Re=n.createContext(ns);function rs({children:t,defaultTheme:s="system",storageKey:a="vite-ui-theme",...l}){const[r,o]=n.useState(()=>localStorage.getItem(a)||s);n.useEffect(()=>{const c=window.document.documentElement;if(c.classList.remove("light","dark"),r==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";c.classList.add(m);return}c.classList.add(r)},[r]);const i={theme:r,setTheme:c=>{localStorage.setItem(a,c),o(c)}};return e.jsx(Re.Provider,{...l,value:i,children:t})}const Le=()=>{const t=n.useContext(Re);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},C=me(t=>({tablesSchema:{},indexesSchema:[],currentTable:null,data:null,columns:null,maxSize:1,isDatabaseLoading:!1,isDataLoading:!1,errorMessage:null,filters:null,sorters:null,limit:50,offset:0,customQuery:void 0,customQueryObject:null,setTablesSchema:s=>t({tablesSchema:s}),setIndexesSchema:s=>t({indexesSchema:s}),setCurrentTable:s=>t({currentTable:s}),setData:s=>t({data:s}),setColumns:s=>t({columns:s}),setMaxSize:s=>t({maxSize:s}),setIsDatabaseLoading:s=>t({isDatabaseLoading:s}),setIsDataLoading:s=>t({isDataLoading:s}),setErrorMessage:s=>t({errorMessage:s}),setFilters:s=>t({filters:s}),setSorters:s=>t({sorters:s}),setLimit:s=>t({limit:s}),setOffset:s=>t({offset:s}),setCustomQuery:s=>t({customQuery:s}),setCustomQueryObject:s=>t({customQueryObject:s}),resetPagination:()=>t({offset:0}),resetFiltersAndSorters:()=>t({filters:null,sorters:null})})),A=me((t,s)=>({schemaPanelSize:0,dataPanelSize:100,topPanelSize:0,bottomPanelSize:100,query:"",editValues:[],selectedRow:null,isInserting:!1,isMobile:window.matchMedia("(max-width: 768px)").matches,setSchemaPanelSize:a=>t({schemaPanelSize:a}),setDataPanelSize:a=>t({dataPanelSize:a}),setTopPanelSize:a=>t({topPanelSize:a}),setBottomPanelSize:a=>t({bottomPanelSize:a}),setQuery:a=>t({query:a}),setEditValues:a=>t({editValues:a}),setSelectedRow:a=>t({selectedRow:a}),setIsInserting:a=>t({isInserting:a}),setIsMobile:a=>t({isMobile:a}),resetEditSection:()=>t(()=>{const a=s().isMobile,l={isInserting:!1,selectedRow:null,topPanelSize:0,bottomPanelSize:100};return a&&(l.schemaPanelSize=0,l.dataPanelSize=100),l}),setPanelsForDevice:()=>t(()=>s().isMobile?{schemaPanelSize:0,dataPanelSize:100}:{schemaPanelSize:25,dataPanelSize:75})})),Pe=n.createContext(void 0),ls=({children:t})=>{const{setPanelsForDevice:s,setTopPanelSize:a,setBottomPanelSize:l,setSchemaPanelSize:r,setDataPanelSize:o,isMobile:i}=A(),[c,m]=n.useState(null),[x,u]=n.useState(!1),d=c!==null||x;n.useEffect(()=>{s()},[s]);const b=n.useCallback((E,L)=>{u(!1),m({data:E,index:L}),i?(a(100),l(0),o(0),r(100)):(a(75),l(25))},[i,l,o,r,a]),v=n.useCallback(()=>{m(null),u(!0),i?(a(100),l(0),o(0),r(100)):(a(75),l(25))},[i,l,o,r,a]),N=n.useCallback(()=>{u(!1),m(null)},[]),w=n.useCallback(()=>{u(!1),m(null),a(0),l(100),o(100),r(0)},[a,l,o,r]),M=n.useCallback(()=>{i&&(o(100),r(0))},[i,o,r]),T={handleRowClick:b,handleInsert:v,handlePanelReset:N,isEditing:d,selectedRowObject:c,isInserting:x,setIsInserting:u,setSelectedRowObject:m,goBackToData:w,expandDataPanel:M};return e.jsx(Pe.Provider,{value:T,children:t})},B=()=>{const t=n.useContext(Pe);if(t===void 0)throw new Error("usePanelManager must be used within a PanelProvider");return t},ke=n.createContext(void 0),os=({children:t})=>{const s=n.useRef(null),{setTablesSchema:a,setIndexesSchema:l,setCurrentTable:r,setData:o,setColumns:i,setMaxSize:c,setIsDatabaseLoading:m,setIsDataLoading:x,setErrorMessage:u,filters:d,sorters:b,limit:v,offset:N,currentTable:w,maxSize:M,setOffset:T,setFilters:E,setSorters:L,setLimit:be,resetPagination:K,setCustomQueryObject:ne,customQuery:ge}=C(),{resetEditSection:re}=A(),{selectedRowObject:q,setSelectedRowObject:U,setIsInserting:X}=B(),[je,Fe]=n.useState(!0);n.useEffect(()=>(s.current=new Worker(new URL("/assets/sqliteWorker-C17v2t7b.js",import.meta.url),{type:"module"}),s.current.onmessage=h=>{var S,y,z,P,k,V,G,Q,ve,Ne,we,Se;const{action:f,payload:p}=h.data;if(f==="initComplete")a(p.tableSchema),l(p.indexSchema),r(p.currentTable),E(null),L(null),U(null),X(!1),m(!1);else if(f==="queryComplete")c(p.maxSize),(((y=(S=p.results)==null?void 0:S[0])==null?void 0:y.values)||[]).length!==0?(o(((P=(z=p.results)==null?void 0:z[0])==null?void 0:P.values)||[]),i(((V=(k=p.results)==null?void 0:k[0])==null?void 0:V.columns)||[])):o(null),x(!1);else if(f==="customQueryComplete")(((Q=(G=p.results)==null?void 0:G[0])==null?void 0:Q.values)||[]).length!==0?ne({data:((Ne=(ve=p.results)==null?void 0:ve[0])==null?void 0:Ne.values)||[],columns:((Se=(we=p.results)==null?void 0:we[0])==null?void 0:Se.columns)||[]}):ne(null),x(!1),u(null);else if(f==="updateInstance")a(p.tableSchema),l(p.indexSchema),x(!1),u(null),Y.success("Database schema updated successfully");else if(f==="updateComplete")u(null),re(),Y.success(`Row ${p.type} successfully`);else if(f==="insertComplete")u(null),re(),Y.success("Row inserted successfully");else if(f==="downloadComplete"){const _=new Blob([p.bytes],{type:"application/octet-stream"}),le=URL.createObjectURL(_),O=document.createElement("a");O.href=le,O.download="database.sqlite",O.click()}else if(f==="exportComplete"){const _=new Blob([p.results],{type:"text/csv"}),le=URL.createObjectURL(_),O=document.createElement("a");O.href=le,O.download="export.csv",O.click()}else f==="queryError"?(console.error("Worker error:",p.error),p.error.isCustomQueryError?u(p.error.message):Y.error(p.error.message),x(!1)):console.warn("Unknown action:",f)},m(!0),s.current.postMessage({action:"init"}),()=>{var h;(h=s.current)==null||h.terminate()}),[i,m,a,r,l,ne,o,c,x,u,E,L,re,U,X]),n.useEffect(()=>{if(!w)return;const h=setTimeout(()=>{var P,k,V,G,Q;x(!0);let f=50;const p=(P=document.getElementById("tableHeader"))==null?void 0:P.getBoundingClientRect().height,S=(k=document.getElementById("dataSection"))==null?void 0:k.getBoundingClientRect().height,y=(V=document.getElementById("tableCell"))==null?void 0:V.getBoundingClientRect().height,z=(G=document.getElementById("paginationControls"))==null?void 0:G.getBoundingClientRect().height;je?(Fe(!1),S&&z&&(f=Math.floor((S-z-53)/33))):p&&S&&z&&y&&(f=Math.floor((S-p-z)/y)),be(f),(Q=s.current)==null||Q.postMessage({action:"getTableData",payload:{currentTable:w,filters:d,sorters:b,limit:f,offset:N}})},100);return()=>clearTimeout(h)},[w,d,b,je,N,be,x]);const Ue=n.useCallback(h=>{var S;const f=(S=h.target.files)==null?void 0:S[0];if(!f)return;const p=new FileReader;p.onload=y=>{var P,k;const z=(P=y.target)==null?void 0:P.result;(k=s.current)==null||k.postMessage({action:"openFile",payload:{file:z}})},p.readAsArrayBuffer(f)},[]),He=n.useCallback(()=>{var h;(h=s.current)==null||h.postMessage({action:"download"})},[]),Ve=n.useCallback(h=>{E(null),L(null),K(),c(0),U(null),X(!1),r(h)},[E,L,K,c,r,U,X]),Ge=n.useCallback((h,f)=>{const S={...C.getState().filters||{},[h]:f};E(S),K()},[E,K]),Qe=n.useCallback(h=>{const S=((C.getState().sorters||{})[h]||"asc")==="asc"?"desc":"asc",y={[h]:S};L(y)},[L]),_e=n.useCallback(h=>{const f=C.getState().offset;typeof h=="number"?T(h):h==="next"?T(f+v):h==="prev"?T(f-v):h==="first"?T(0):h==="last"&&T(M-v),U(null)},[M,v,T,U]),$e=n.useCallback(h=>{var f;(f=s.current)==null||f.postMessage({action:"export",payload:{table:w,offset:N,limit:v,filters:d,sorters:b,exportType:h}})},[w,d,b,N,v]),We=n.useCallback(()=>{var S;const h=ge;if(!h)return;const p=h.replace(/--.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").split(";").map(y=>y.trim()).filter(y=>y!=="");for(const y of p)x(!0),(S=s.current)==null||S.postMessage({action:"exec",payload:{query:y,currentTable:w,filters:d,sorters:b,limit:v,offset:N}})},[w,d,b,v,N,x,ge]),Ke=n.useCallback(h=>{var f,p;x(!0),(f=s.current)==null||f.postMessage({action:h,payload:{table:w,columns:C.getState().columns,values:A.getState().editValues,whereValues:q==null?void 0:q.data}}),(p=s.current)==null||p.postMessage({action:"refresh",payload:{currentTable:w,offset:N,limit:v,filters:d,sorters:b}})},[w,d,b,N,v,x,q]),qe={workerRef:s,handleFileChange:Ue,handleDownload:He,handleTableChange:Ve,handleQueryFilter:Ge,handleQuerySorter:Qe,handlePageChange:_e,handleExport:$e,handleQueryExecute:We,handleEditSubmit:Ke};return e.jsx(ke.Provider,{value:qe,children:t})},R=()=>{const t=n.useContext(ke);if(t===void 0)throw new Error("useDatabaseWorker must be used within a DatabaseWorkerProvider");return t};function j(...t){return wt(Nt(t))}const is=n.memo(function({className:s,...a}){return e.jsx(Ze,{"data-slot":"tabs",className:j("flex flex-col",s),...a})});function cs({className:t,...s}){return e.jsx(st,{"data-slot":"tabs-list",className:j("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}const oe=de.memo(function({className:s,...a}){return e.jsx(et,{"data-slot":"tabs-trigger",className:j("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}),ie=de.memo(function({className:s,...a}){return e.jsx(tt,{"data-slot":"tabs-content",className:j("flex-1 outline-none",s),...a})}),ds=St("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),ms=({className:t,variant:s,size:a,asChild:l=!1,onClick:r,...o})=>{const i=l?at:"button",c=n.useCallback(x=>{r&&r(x)},[r]),m=n.useMemo(()=>j(ds({variant:s,size:a,className:t})),[s,a,t]);return e.jsx(i,{"data-slot":"button",className:m,onClick:c,...o})},g=n.memo(ms),us=({className:t,type:s,...a})=>e.jsx("input",{type:s,"data-slot":"input",className:j("border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a}),ae=n.memo(us);function xs(){const{theme:t,setTheme:s}=Le();return e.jsx(g,{variant:"outline",onClick:()=>s(t==="dark"?"light":"dark"),"aria-label":t==="dark"?"Switch to light mode":"Switch to dark mode",title:t==="dark"?"Switch to light mode":"Switch to dark mode",className:"relative flex items-center justify-center transition-transform duration-300",children:t==="dark"?e.jsx(Ct,{className:"h-[1.2rem] w-[1.2rem]"}):e.jsx(yt,{className:"h-[1.2rem] w-[1.2rem]"})})}const hs=()=>{const{handleFileChange:t,handleDownload:s}=R();return n.useMemo(()=>e.jsxs("header",{className:"flex items-center justify-between gap-1 border-b p-1",children:[e.jsxs("section",{className:"flex items-center gap-1",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative w-full cursor-pointer",children:[e.jsx(ae,{id:"file-upload",type:"file",className:"absolute inset-0 cursor-pointer opacity-0",onChange:t}),e.jsxs(g,{size:"sm",variant:"outline",className:"w-full text-xs",children:[e.jsx(ye,{className:"h-3 w-3"}),"Open Database"]})]}),e.jsxs(g,{size:"sm",variant:"outline",className:"text-xs",onClick:s,title:"Save the database",children:[e.jsx(Tt,{className:"h-3 w-3"}),"Save Database"]})]}),e.jsx(xs,{})]}),[t,s])},he=me(t=>({expandedTables:[],expandedTableSection:!0,expandedIndexSection:!0,toggleTable:s=>t(a=>({expandedTables:a.expandedTables.includes(s)?a.expandedTables.filter(l=>l!==s):[...a.expandedTables,s]})),toggleTableSection:()=>t(s=>({expandedTableSection:!s.expandedTableSection})),toggleIndexSection:()=>t(s=>({expandedIndexSection:!s.expandedIndexSection})),expandAllTables:s=>t({expandedTables:Object.keys(s)}),collapseAllTables:()=>t({expandedTables:[]}),resetState:()=>t({expandedTables:[],expandedTableSection:!0,expandedIndexSection:!0})})),I=n.memo(function({children:s,className:a}){return e.jsx("span",{className:`block max-w-80 overflow-hidden text-ellipsis ${a??""}`,children:s})}),ps={DATE:/DATE|TIMESTAMP/i,BLOB:/^BLOB$/i,TEXT:/CHAR|TEXT|CLOB|VARCHAR/i,INTEGER:/INT/i,REAL:/REAL|FLOAT|DOUBLE|DECIMAL/i,NUMERIC:/NUMERIC/i,BOOLEAN:/BOOL/i},F=(t,s)=>ps[s].test(t),fs=t=>F(t,"DATE"),bs=t=>F(t,"BLOB"),gs=t=>F(t,"TEXT"),js=t=>F(t,"NUMERIC"),vs=t=>F(t,"BOOLEAN"),Ns=t=>F(t,"INTEGER"),ws=t=>F(t,"REAL"),Ss=t=>Ns(t)||ws(t)||js(t),Cs=n.memo(Et),ys=n.memo(It),Ts=n.memo(zt),Es=n.memo(Rt),Is=n.memo(Lt),zs=n.memo(Pt),Rs=n.memo(kt),Ls=n.memo(Dt),pe=n.memo(({columnSchema:t})=>{if(!t)return null;const{type:s,isPrimaryKey:a,isForeignKey:l}=t;let r=null;return s&&(r=bs(s)?e.jsx(Ts,{className:"h-4 w-4 text-green-500"}):fs(s)?e.jsx(Es,{className:"h-4 w-4 text-blue-500"}):gs(s)?e.jsx(Is,{className:"h-4 w-4 text-indigo-500"}):Ss(s)?e.jsx(zs,{className:"h-4 w-4 text-red-500"}):vs(s)?e.jsx(Rs,{className:"h-4 w-4 text-pink-500"}):e.jsx(Ls,{className:"h-4 w-4 text-gray-500"})),e.jsxs("div",{className:"flex items-center gap-[2px]",children:[a&&e.jsx(Cs,{className:"h-4 w-4 text-yellow-500"}),l&&e.jsx(ys,{className:"h-4 w-4 text-purple-500"}),r]})}),Ps=n.memo(({columnSchema:t})=>e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{columnSchema:t}),e.jsx("span",{className:"text-primary/60 ml-1 text-xs",children:t.name})]}),e.jsx(I,{className:"text-primary/60 text-xs whitespace-nowrap",children:t.type})]})),ks=n.memo(se),Ds=n.memo(Te),De=n.memo(({expanded:t,size:s=4})=>t?e.jsx(ks,{className:`h-${s} w-${s}`}):e.jsx(Ds,{className:`h-${s} w-${s}`})),As=n.memo(({name:t,table:s})=>{const{expandedTables:a,toggleTable:l}=he(),r=a.includes(t),o=()=>l(t),i=c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),l(t))};return e.jsxs("article",{children:[e.jsxs("div",{className:j("flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",r&&"ml-1"),onClick:o,onKeyDown:i,"aria-expanded":r,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(De,{expanded:r})}),e.jsxs("span",{className:"flex items-center gap-1 capitalize",children:[e.jsx("span",{className:"text-sm",children:t}),e.jsxs("span",{className:"text-primary/50 text-xs",children:["(",s.schema.length,")"]})]})]}),r&&e.jsx("div",{className:"border-primary/20 mt-1 mb-2 ml-4 flex flex-col gap-1 space-y-0.5 border-l-2 pl-2",children:s.schema.map((c,m)=>e.jsx(Ps,{columnSchema:c},m))})]})}),Ae=n.memo(({title:t,expanded:s,icon:a,onToggle:l,children:r})=>{const o=i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),l())};return e.jsxs("header",{className:j("hover:bg-primary/5 bg-primary/7 flex cursor-pointer items-center px-2 py-2 transition-colors",!s&&"mb-0"),onClick:l,onKeyDown:o,"aria-expanded":s,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(De,{expanded:s,size:5})}),a,e.jsx("span",{children:t}),r]})}),Ms=n.memo(({tablesSchema:t})=>{const{expandedTableSection:s,toggleTableSection:a,expandAllTables:l,collapseAllTables:r}=he(),[o,i]=n.useState(!1),c=u=>{u.stopPropagation(),l(t),i(!0)},m=u=>{u.stopPropagation(),r(),i(!1)},x=s&&e.jsx("div",{className:"ml-auto flex",children:o?e.jsx(g,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:m,"aria-label":"Collapse all tables",children:e.jsx(Ot,{className:"h-4 w-4"})}):e.jsx(g,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:c,"aria-label":"Expand all tables",children:e.jsx(Bt,{className:"h-4 w-4"})})});return e.jsxs("section",{children:[e.jsx(Ae,{title:"Tables",expanded:s,icon:e.jsx(ye,{className:"mr-2 h-4 w-4"}),onToggle:a,children:x}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:Object.entries(t).map(([u,d])=>e.jsx(As,{name:u,table:d},u))})]})}),Os=n.memo(({index:t})=>e.jsx("article",{children:e.jsx("div",{className:"flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[e.jsx("span",{className:"text-sm",children:t.name}),e.jsx(I,{className:"text-primary/60 text-xs font-medium whitespace-nowrap",children:t.tableName})]})})})),Bs=n.memo(({indexes:t})=>{const{expandedIndexSection:s,toggleIndexSection:a}=he();return e.jsxs("section",{children:[e.jsx(Ae,{title:"Indexes",expanded:s,icon:e.jsx(Ee,{className:"mr-2 h-4 w-4"}),onToggle:a}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:t.map((l,r)=>e.jsx(Os,{index:l},r))})]})}),Fs=n.memo(({onFilterChange:t})=>e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"text-primary/40 absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2 transform"}),e.jsx(ae,{placeholder:"Search tables and indexes",className:"border-primary/20 h-8 w-full pl-8 text-sm text-[0.8rem]!",onChange:s=>t(s.target.value),"aria-label":"Search tables and indexes"})]})),Us=n.memo(({tableCount:t,indexCount:s})=>e.jsxs("footer",{className:"bg-primary/5 text-primary/60 flex items-center justify-between gap-2 border-t p-2 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Mt,{className:"mr-1 h-3 w-3 text-wrap"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[t," Tables"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ee,{className:"mr-1 h-3 w-3"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[s," Indexes"]})]})]})),fe=()=>{const[t,s]=n.useState(""),{tablesSchema:a,indexesSchema:l}=C(),r=n.useMemo(()=>{if(!t)return a;const i={};for(const[c,m]of Object.entries(a))c.toLowerCase().includes(t.toLowerCase())&&(i[c]=m);return i},[a,t]),o=n.useMemo(()=>t?l.filter(i=>i.name.toLowerCase().includes(t.toLowerCase())||i.tableName.toLowerCase().includes(t.toLowerCase())):l,[l,t]);return e.jsxs("main",{className:"flex h-full w-full flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-primary/5 border-b p-2",children:e.jsx(Fs,{onFilterChange:s})}),e.jsxs("nav",{className:"flex-1 overflow-auto",children:[e.jsx(Ms,{tablesSchema:r}),l.length>0&&e.jsx(Bs,{indexes:o})]}),e.jsx(Us,{tableCount:Object.keys(a).length,indexCount:l.length})]})},Hs=()=>{const t=n.useMemo(()=>e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(fe,{})}),[]);return e.jsx("div",{className:"flex h-full flex-col",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:t})})};function Z({className:t,...s}){return e.jsx(qt,{"data-slot":"resizable-panel-group",className:j("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...s})}function D(t){return e.jsx(Xt,{"data-slot":"resizable-panel",...t})}function ee({withHandle:t,className:s,...a}){return e.jsx(Yt,{"data-slot":"resizable-handle",className:j("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",s),...a,children:t&&e.jsx("div",{className:"bg-border border-primary/20 z-50 flex h-9 w-4 items-center justify-center rounded-xs border",children:e.jsx(Ft,{className:"size-2.5"})})})}function Vs({...t}){return e.jsx(rt,{"data-slot":"select",...t})}function Gs({...t}){return e.jsx(it,{"data-slot":"select-value",...t})}function Qs({className:t,children:s,...a}){return e.jsxs(lt,{"data-slot":"select-trigger",className:j("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a,children:[s,e.jsx(ot,{asChild:!0,children:e.jsx(se,{className:"size-4 opacity-50"})})]})}function _s({className:t,children:s,position:a="popper",...l}){return e.jsx(ct,{children:e.jsxs(dt,{"data-slot":"select-content",className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...l,children:[e.jsx(Ws,{}),e.jsx(mt,{className:j("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(Ks,{})]})})}function $s({className:t,children:s,...a}){return e.jsxs(ut,{"data-slot":"select-item",className:j("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(xt,{children:e.jsx(Ht,{className:"size-4"})})}),e.jsx(ht,{children:s})]})}const Ws=de.memo(function({className:s,...a}){return e.jsx(nt,{"data-slot":"select-scroll-up-button",className:j("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ut,{className:"size-4"})})});function Ks({className:t,...s}){return e.jsx(pt,{"data-slot":"select-scroll-down-button",className:j("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(se,{className:"size-4"})})}const qs=()=>{const{tablesSchema:t,currentTable:s}=C(),{handleTableChange:a}=R();return n.useMemo(()=>e.jsxs(Vs,{onValueChange:a,value:s||void 0,children:[e.jsx(Qs,{className:"border-primary/20 h-8 w-30 border text-sm sm:w-48",children:e.jsx(Gs,{placeholder:"Select Table"})}),e.jsx(_s,{children:Object.keys(t).map(r=>e.jsx($s,{value:r,children:e.jsx(I,{className:"capitalize",children:r})},r))})]}),[t,s,a])};function Xs({...t}){return e.jsx(ft,{"data-slot":"dropdown-menu",...t})}function Ys({...t}){return e.jsx(bt,{"data-slot":"dropdown-menu-trigger",...t})}function Js({className:t,sideOffset:s=4,...a}){return e.jsx(gt,{children:e.jsx(jt,{"data-slot":"dropdown-menu-content",sideOffset:s,className:j("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...a})})}function $({className:t,inset:s,variant:a="default",...l}){return e.jsx(vt,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":a,className:j("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l})}const Zs=()=>{const{handleExport:t}=R(),{isInserting:s,handleInsert:a}=B(),{filters:l,setFilters:r,sorters:o,setSorters:i}=C();return n.useMemo(()=>e.jsxs(Xs,{children:[e.jsx(Ys,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",className:"h-8 text-xs",children:["Actions ",e.jsx(se,{className:"ml-1 h-3 w-3"})]})}),e.jsxs(Js,{className:"w-40",children:[e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>r(null),disabled:l==null,title:"Clear applied filters",children:[e.jsx(ue,{className:"mr-1 h-3 w-3"}),"Clear filters"]})}),e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>i(null),disabled:o==null,title:"Reset sorting",children:[e.jsx(Ie,{className:"mr-1 h-3 w-3"}),"Reset sorting"]})}),e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:a,disabled:s,title:"Insert a new row",children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]})}),e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("table"),title:"Export the current table as CSV",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Export table"]})}),e.jsx($,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("current"),title:"Export the current data as CSV",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Export data"]})})]})]}),[l,o,t,a,s,r,i])},ea=()=>{const{handleEditSubmit:t}=R(),{selectedRowObject:s,isInserting:a,goBackToData:l}=B(),{editValues:r,setEditValues:o}=A(),{tablesSchema:i,currentTable:c,columns:m}=C();n.useEffect(()=>{a?o((m==null?void 0:m.map(()=>""))||[]):s&&o(s.data.map(d=>(d==null?void 0:d.toString())??""))},[a,s,m,o]);const x=n.useCallback((d,b)=>{const v=A.getState().editValues;o(v.map((N,w)=>w===d?b:N))},[o]);return n.useMemo(()=>e.jsx("section",{className:"h-full overflow-auto",children:e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsxs("div",{className:"overflow-auto",children:[e.jsxs("div",{className:"bg-primary/5 flex w-full items-center justify-between gap-1 border-b p-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(I,{className:"whitespace-nowrap",children:"Inserting row"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(I,{className:"whitespace-nowrap",children:"Updating row"})]})}),e.jsxs(g,{size:"sm",variant:"outline",className:"text-xs md:hidden",onClick:l,"aria-label":"Go back to data",children:[e.jsx(ze,{className:"mr-1 h-3 w-3"}),"Go back"]})]}),m==null?void 0:m.map((d,b)=>{var v;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:d,className:"bg-primary/5 flex items-center gap-1 rounded-sm p-2",children:[e.jsx(pe,{columnSchema:(v=i[c])==null?void 0:v.schema[b]}),e.jsx(I,{className:"text-xs font-medium capitalize",children:d})]}),e.jsx(ae,{id:d,name:d,className:"border-primary/20 h-8 rounded-none text-sm text-[0.8rem]!",value:r[b]||"",onChange:N=>x(b,N.target.value)})]},d)})]}),e.jsxs("div",{className:"flex w-full",children:[e.jsx(g,{size:"sm",variant:"outline",className:"w-full text-xs",onClick:()=>t(a?"insert":"update"),"aria-label":a?"Insert row":"Apply changes",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"mr-1 h-3 w-3"}),"Apply changes"]})}),!a&&e.jsx(g,{size:"sm",variant:"destructive",className:"rounded-none text-xs",onClick:()=>t("delete"),"aria-label":"Delete row",children:e.jsx(Vt,{className:"h-3 w-3"})})]})]})}),[c,i,m,r,x,t,a,l])},Me=n.memo(function({className:s,...a}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:j("w-full caption-bottom text-sm",s),...a})})}),Oe=n.memo(function({className:s,...a}){return e.jsx("thead",{"data-slot":"table-header",id:"tableHeader",className:j("[&_tr]:border-b",s),...a})}),Be=n.memo(function({className:s,...a}){return e.jsx("tbody",{"data-slot":"table-body",className:j("[&_tr:last-child]:border-0",s),...a})});n.memo(function({className:s,...a}){return e.jsx("tfoot",{"data-slot":"table-footer",className:j("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",s),...a})});const H=n.memo(function({className:s,...a}){return e.jsx("tr",{"data-slot":"table-row",className:j("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...a})}),ce=n.memo(function({className:s,...a}){return e.jsx("th",{"data-slot":"table-head",className:j("text-muted-foreground min-h-6 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),te=n.memo(function({className:s,...a}){return e.jsx("td",{"data-slot":"table-cell",id:"tableCell",className:j("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),ta=n.memo(({column:t,value:s,onChange:a})=>{const l=n.useCallback(r=>a(t,r.target.value),[t,a]);return e.jsx(ae,{type:"text",className:"border-primary/20 max-h-6 w-full rounded px-2 py-1 text-[0.8rem]!",value:s,onChange:l,placeholder:"Filter"})}),sa=n.memo(Gt),aa=n.memo(Qt),na=n.memo(_t),ra=n.memo(({column:t})=>{const{sorters:s}=C(),{handleQuerySorter:a}=R();return e.jsx(e.Fragment,{children:s!=null&&s[t]?s[t]==="asc"?e.jsx("button",{title:"Sort column in descending order",type:"button","aria-label":"Sort Descending",onClick:()=>a(t),children:e.jsx(na,{className:"h-4 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Ascending",onClick:()=>a(t),children:e.jsx(aa,{className:"h-3 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Column",onClick:()=>a(t),children:e.jsx(sa,{className:"h-3 w-3"})})})}),la=()=>{const{data:t,columns:s,currentTable:a,tablesSchema:l,filters:r,setFilters:o}=C(),{handleQueryFilter:i}=R(),{handleRowClick:c,selectedRowObject:m}=B(),x=n.useMemo(()=>e.jsx("div",{className:"flex h-full flex-col items-center justify-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-md font-medium",children:"No Data To Show For Current Filters"}),e.jsxs(g,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>o(null),children:[e.jsx(ue,{className:"mr-1 h-3 w-3"}),"Clear filters"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-md font-medium",children:"No Data To Show"}),e.jsx("p",{className:"text-sm",children:"This table does not have any data to display"})]})}),[r,o]),u=n.useMemo(()=>(s||[]).map(d=>e.jsx(ta,{column:d,value:(r==null?void 0:r[d])||"",onChange:i},d)),[s,r,i]);return n.useMemo(()=>e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(H,{className:"bg-primary/5",children:s&&a?s.map((d,b)=>e.jsxs(ce,{className:"p-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 py-[1.5px]",children:[e.jsx(ra,{column:d}),e.jsx(I,{className:"text-foreground font-medium capitalize",children:d}),e.jsx(pe,{columnSchema:l[a].schema[b]})]}),u==null?void 0:u[b]]},d)):e.jsx(ce,{children:e.jsx("p",{className:"text-xs",children:"No columns found"})})})}),e.jsx(Be,{children:t&&t.length>0?t.map((d,b)=>e.jsx(H,{onClick:()=>c(d,b),className:`hover:bg-primary/5 cursor-pointer text-xs ${(m==null?void 0:m.index)===b?"bg-primary/5":""}`,children:d.map((v,N)=>{var w;return e.jsx(te,{className:"p-2",children:v?e.jsx(e.Fragment,{children:((w=l[a].schema[N])==null?void 0:w.type)==="BLOB"?e.jsx("span",{className:"text-muted-foreground italic",children:"BLOB"}):e.jsx(I,{children:v})}):e.jsx("span",{className:"text-muted-foreground italic",children:"NULL"})},N)})},b)):e.jsx(H,{children:e.jsx(te,{colSpan:(s==null?void 0:s.length)||1,className:"h-32 text-center",children:x})})})]}),[t,s,a,l,c,m,x,u])},oa=()=>{const{handlePageChange:t,handleExport:s}=R(),{isInserting:a,handleInsert:l}=B(),{offset:r,limit:o,maxSize:i,isDataLoading:c}=C();return n.useMemo(()=>e.jsxs("footer",{className:"bg-background flex w-full items-center justify-between border-t",id:"paginationControls",children:[e.jsxs("section",{className:"bg-primary/10 flex grow items-center gap-1 p-2",children:[e.jsx(g,{onClick:()=>t("first"),disabled:r===0||c,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the first data",children:e.jsx($t,{className:"h-4 w-4"})}),e.jsx(g,{onClick:()=>t("prev"),disabled:r===0||c,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the previous data",children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-2 text-xs whitespace-nowrap",children:[r+1," -> ",r+o>i?i:r+o," of ",i]}),e.jsx(g,{onClick:()=>t("next"),disabled:r+o>=i||c,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the next data",children:e.jsx(Te,{className:"h-4 w-4"})}),e.jsx(g,{onClick:()=>t("last"),disabled:r+o>=i||c,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the last data",children:e.jsx(Wt,{className:"h-4 w-4"})})]}),e.jsxs("section",{className:"bg-primary/10 hidden items-center gap-1 p-2 md:flex",children:[e.jsxs(g,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:l,disabled:a,children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}),e.jsxs(g,{onClick:()=>s("current"),size:"sm",variant:"outline",className:"h-7 text-xs",title:"Export current data as CSV",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Export data"]})]})]}),[i,t,c,s,a,r,o,l])},ia=n.memo(()=>{const{filters:t,sorters:s,setFilters:a,setSorters:l,isDataLoading:r,isDatabaseLoading:o}=C(),{dataPanelSize:i,schemaPanelSize:c,topPanelSize:m,bottomPanelSize:x,setDataPanelSize:u,setSchemaPanelSize:d,setTopPanelSize:b,setBottomPanelSize:v}=A(),{handleExport:N}=R(),{selectedRowObject:w,isInserting:M}=B(),T=n.useMemo(()=>e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(fe,{})}),[]),E=n.useMemo(()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden items-center gap-1 md:flex",children:[e.jsxs(g,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>a(null),disabled:t==null,title:"Clear applied filters",children:[e.jsx(ue,{className:"mr-1 h-3 w-3"}),"Clear filters"]}),e.jsxs(g,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>l(null),disabled:s==null,title:"Reset sorting",children:[e.jsx(Ie,{className:"mr-1 h-3 w-3"}),"Reset sorting"]}),e.jsxs(g,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>N("table"),title:"Export the current table as CSV",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Export table"]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(Zs,{})})]}),[t,s,a,l,N]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsx(qs,{}),E,(r||o)&&e.jsx(ca,{text:"Loading data"})]}),e.jsx("div",{className:"h-full overflow-hidden",children:e.jsxs(Z,{direction:"horizontal",className:"h-full",children:[e.jsx(D,{id:"dataPanel",defaultSize:i,onResize:u,children:e.jsxs("div",{className:"flex h-full flex-col justify-between border-l",id:"dataSection",children:[e.jsx(la,{}),e.jsx(oa,{})]})},`data-${i}`),e.jsx(ee,{withHandle:!0}),e.jsx(D,{id:"schemaPanel",defaultSize:c,onResize:d,className:"",children:e.jsxs(Z,{direction:"vertical",children:[e.jsx(D,{id:"topPanel",defaultSize:m,onResize:b,className:`${w||M?"":"hidden"}`,children:e.jsx(ea,{})},`top-${m}`),e.jsx(ee,{className:`${w||M?"":"hidden"}`,withHandle:!0}),e.jsx(D,{id:"bottomPanel",defaultSize:x,onResize:v,children:e.jsx("div",{className:"h-full overflow-hidden",children:T})},`bottom-${x}`)]})},`schema-${c}`)]})})]})}),ca=({text:t})=>e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(xe,{className:"mr-1 h-3 w-3 animate-spin"}),t]}),da=["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"],ma=["ABS","ACOS","ASIN","ATAN","CEIL","COS","EXP","FLOOR","HEX","LENGTH","LOG","LOWER","LTRIM","OCT","PI","POW","ROUND","SIGN","SIN","SQRT","TAN","TRIM","UPPER"];function ua(){const{theme:t}=Le(),{customQuery:s,setCustomQuery:a,tablesSchema:l}=C(),{tableNames:r,columnNames:o}=n.useMemo(()=>{const u=Object.keys(l),d=u.flatMap(b=>l[b].schema.map(v=>v.name));return{tableNames:u,columnNames:d}},[l]),i=n.useMemo(()=>[...da.map(u=>({label:u,type:"keyword"})),...ma.map(u=>({label:u,type:"function"})),...r.map(u=>({label:u,type:"table"})),...o.map(u=>({label:u,type:"column"}))],[r,o]),c=n.useCallback(u=>{const d=u.matchBefore(/\w*/);return!d||d.from===d.to&&!u.explicit?null:{from:d.from,to:d.to,options:i}},[i]),m=n.useCallback(u=>{a(u)},[a]),x=n.useMemo(()=>[es,ts(),ss({override:[c]})],[c]);return e.jsx(Jt,{value:s,height:"100%",extensions:x,onChange:m,className:"h-full w-full",theme:t==="dark"?Zt:"light"})}const xa=()=>{const{customQueryObject:t}=C();return n.useMemo(()=>{var s;return e.jsx(e.Fragment,{children:t?e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(H,{className:"bg-primary/5",children:t.columns.map(a=>e.jsx(ce,{className:"p-1 text-xs",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(I,{className:"text-foreground font-medium capitalize",children:a})})},a))})}),e.jsx(Be,{children:t.data&&t.data.length>0?t.data.map((a,l)=>e.jsx(H,{className:"hover:bg-primary/5 text-xs",children:a.map((r,o)=>e.jsx(te,{className:"p-2",children:r?e.jsx(I,{children:r}):e.jsx("span",{className:"text-muted-foreground italic",children:"NULL"})},o))},l)):e.jsx(H,{children:e.jsx(te,{colSpan:((s=t==null?void 0:t.columns)==null?void 0:s.length)||1,className:"h-32 text-center",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1",children:[e.jsx("h3",{className:"text-md font-medium",children:"No Data To Show"}),e.jsx("p",{className:"text-sm",children:"Seems like there is no data to display"})]})})})})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1",children:[e.jsx("h3",{className:"text-md font-medium",children:"No Data To Show"}),e.jsx("p",{className:"text-sm",children:"Execute a query to view data"})]})})},[t])},ha=()=>{const{customQueryObject:t,errorMessage:s,isDataLoading:a,isDatabaseLoading:l}=C(),{dataPanelSize:r,schemaPanelSize:o,setDataPanelSize:i,setSchemaPanelSize:c}=A(),{handleQueryExecute:m}=R(),x=n.useMemo(()=>e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(fe,{})}),[]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsxs(g,{size:"sm",variant:"outline",className:"text-xs",onClick:m,title:"Execute SQL",children:[e.jsx(Kt,{className:"mr-1 h-3 w-3"}),"Execute SQL"]}),e.jsxs(g,{size:"sm",variant:"outline",className:"text-xs",disabled:!(t!=null&&t.data),children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Export data"]}),(a||l)&&e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(xe,{className:"mr-1 h-3 w-3 animate-spin"}),"Loading data"]})]}),e.jsx("div",{className:"h-full overflow-hidden",children:e.jsxs(Z,{direction:"horizontal",className:"h-full",children:[e.jsx(D,{defaultSize:r,onResize:i,children:e.jsxs(Z,{direction:"vertical",children:[e.jsxs(D,{defaultSize:25,children:[s&&e.jsx("div",{className:"p-2 text-sm text-red-400",children:s}),e.jsx(ua,{})]}),e.jsx(ee,{withHandle:!0}),e.jsx(D,{defaultSize:75,children:e.jsx("div",{className:"flex h-full flex-col justify-between border",children:e.jsx(xa,{})})})]})}),e.jsx(ee,{withHandle:!0}),e.jsx(D,{defaultSize:o,onResize:c,className:"",children:e.jsx("div",{className:"h-full overflow-hidden",children:x})})]})})]})};function pa(){const{isDatabaseLoading:t}=C(),{dataPanelSize:s,setSchemaPanelSize:a,setDataPanelSize:l,isMobile:r}=A(),{expandDataPanel:o}=B(),[i,c]=n.useState("data"),m=n.useCallback(x=>{c(x)},[]);return n.useEffect(()=>{i==="execute"&&s<=0&&o()},[i,s,o]),e.jsxs("main",{className:"bg-primary/5 flex h-screen flex-col overflow-hidden",children:[e.jsx(hs,{}),e.jsxs(is,{value:i,onValueChange:m,className:"flex flex-1 flex-col",children:[e.jsxs(cs,{className:"bg-primary/5 mt-2 h-9 w-full justify-start rounded-none border-b",children:[e.jsx(oe,{id:"structure",disabled:t,value:"structure",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",children:"Database Structure"},"structure"),e.jsx(oe,{id:"data",disabled:t,value:"data",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",children:"Browse Data"},"data"),e.jsx(oe,{disabled:t,id:"execute",value:"execute",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",onClick:()=>{r&&(l(100),a(0))},children:"Execute SQL"},"execute")]}),e.jsxs("div",{className:"max-h-custom-dvh flex-1 overflow-hidden",children:[e.jsx(ie,{value:"data",className:"m-0 h-full border-none p-0",children:t?e.jsx(fa,{message:"Loading Database"}):e.jsx(ia,{})}),e.jsx(ie,{value:"structure",className:"m-0 h-full border-none p-0",children:e.jsx(Hs,{})}),e.jsx(ie,{value:"execute",className:"m-0 h-full border border-none p-0",children:e.jsx(ha,{})})]})]})]})}const fa=({message:t})=>e.jsxs("div",{className:"flex h-full items-center justify-center",children:[e.jsx(xe,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-xl",children:t})]});Xe.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsxs(rs,{defaultTheme:"dark",storageKey:"ui-theme",children:[e.jsx(ls,{children:e.jsx(os,{children:e.jsx(pa,{})})}),e.jsx(as,{richColors:!0})]})}));
