import{j as e,r as n,R as ce}from"./react-g1wVjy4W.js";import{c as $e}from"./react-dom-tIChXhgf.js";import{z as Ke}from"./next-themes-C1hNFtgU.js";import{T as qe,t as I}from"./sonner-BM5nqNKi.js";import{c as de}from"./zustand-Dpr3jGQ2.js";import{l as be}from"./lodash-BkzDGCz7.js";import{R as Xe,T as Ye,C as Je,L as Ze,S as et,a as tt,b as st,c as at,I as rt,V as nt,P as lt,d as ot,e as it,f as ct,g as dt,h as mt,i as ut,j as xt,k as ht,l as pt,m as ft,n as bt}from"./@radix-ui-Bg0YcXMc.js";import{c as gt}from"./clsx-B-dksMZM.js";import{t as jt}from"./tailwind-merge-AdmevC4f.js";import{c as Nt}from"./class-variance-authority-Dp3B9jqt.js";import{S as vt,M as wt,D as je,a as yt,G as St,K as Ct,b as Tt,C as Et,c as It,T as Lt,H as zt,d as Rt,e as kt,f as te,g as Ne,h as ve,i as Dt,j as At,k as Ot,l as Pt,m as Mt,n as Ft,o as Bt,F as me,L as we,P as J,p as Z,q as ge,r as Ut,s as ye,A as Ht,t as Qt,u as Vt,v as _t,w as Gt,x as ue,y as Wt}from"./lucide-react-0VO5i1Gn.js";import{P as $t,a as Kt,b as qt}from"./react-resizable-panels-CXtWjGcq.js";import{R as Xt,d as Yt}from"./@uiw-UsqZQFQK.js";import{G as Jt,I as Zt,r as es}from"./@codemirror-BjKk2IdN.js";import"./scheduler-BNqrtbQi.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-CEOqnfOC.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-DWsGvYUB.js";import"./react-style-singleton-WVrfWbSK.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-JgbaGmrm.js";import"./use-callback-ref-D9jqOmh9.js";import"./@floating-ui-DRmULUd_.js";import"./@babel-Cv5OCJ0e.js";import"./@lezer-E7PapBHi.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const m of r)if(m.type==="childList")for(const d of m.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const m={};return r.integrity&&(m.integrity=r.integrity),r.referrerPolicy&&(m.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?m.credentials="include":r.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(r){if(r.ep)return;r.ep=!0;const m=a(r);fetch(r.href,m)}})();const ts=({...t})=>{const{theme:s="system"}=Ke();return e.jsx(qe,{theme:s,className:"toaster group capitalize",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})},ss={theme:"system",setTheme:()=>null},Se=n.createContext(ss);function as({children:t,defaultTheme:s="system",storageKey:a="vite-ui-theme",...l}){const[r,m]=n.useState(()=>localStorage.getItem(a)||s);n.useEffect(()=>{const h=window.document.documentElement;if(h.classList.remove("light","dark"),r==="system"){const x=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";h.classList.add(x);return}h.classList.add(r)},[r]);const d={theme:r,setTheme:h=>{localStorage.setItem(a,h),m(h)}};return e.jsx(Se.Provider,{...l,value:d,children:t})}const Ce=()=>{const t=n.useContext(Se);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},c=de(t=>({tablesSchema:{},indexesSchema:[],currentTable:null,data:null,columns:null,maxSize:1,isDatabaseLoading:!1,isDataLoading:!1,errorMessage:null,filters:null,sorters:null,limit:50,offset:0,customQuery:void 0,customQueryObject:null,setTablesSchema:s=>t({tablesSchema:s}),setIndexesSchema:s=>t({indexesSchema:s}),setCurrentTable:s=>t({currentTable:s}),setData:s=>t({data:s}),setColumns:s=>t({columns:s}),setMaxSize:s=>t({maxSize:s}),setIsDatabaseLoading:s=>t({isDatabaseLoading:s}),setIsDataLoading:s=>t({isDataLoading:s}),setErrorMessage:s=>t({errorMessage:s}),setFilters:s=>t({filters:s}),setSorters:s=>t({sorters:s}),setLimit:s=>t({limit:s}),setOffset:s=>t({offset:s}),setCustomQuery:s=>t({customQuery:s}),setCustomQueryObject:s=>t({customQueryObject:s}),resetPagination:()=>t({offset:0})})),R=de(t=>{const s=be.debounce(l=>{t({schemaPanelSize:l})},200),a=be.debounce(l=>{t({dataPanelSize:l})},200);return{schemaPanelSize:25,dataPanelSize:75,editValues:[],isInserting:!1,setSchemaPanelSize:s,setDataPanelSize:a,setEditValues:l=>t({editValues:l}),setIsInserting:l=>t({isInserting:l})}}),Te=n.createContext(void 0),rs=({children:t})=>{const[s,a]=n.useState(null),[l,r]=n.useState(!1),m=s!==null||l,d=n.useCallback((g,i,b)=>{r(!1),a({data:g,index:i,primaryValue:b})},[]),h=n.useCallback(()=>{a(null),r(!0)},[]),x=n.useCallback(()=>{r(!1),a(null)},[]),p={handleRowClick:d,handleInsert:h,isEditing:m,selectedRowObject:s,isInserting:l,setIsInserting:r,setSelectedRowObject:a,handleCloseEdit:x};return e.jsx(Te.Provider,{value:p,children:t})},W=()=>{const t=n.useContext(Te);if(t===void 0)throw new Error("usePanelManager must be used within a PanelProvider");return t},Ee=n.createContext(void 0),ns=({children:t})=>{const s=n.useRef(null),a=c(o=>o.setTablesSchema),l=c(o=>o.setIndexesSchema),r=c(o=>o.setCurrentTable),m=c(o=>o.setData),d=c(o=>o.setColumns),h=c(o=>o.setMaxSize),x=c(o=>o.setIsDatabaseLoading),p=c(o=>o.setIsDataLoading),g=c(o=>o.setErrorMessage),i=c(o=>o.filters),b=c(o=>o.sorters),u=c(o=>o.limit),y=c(o=>o.offset),w=c(o=>o.currentTable),T=c(o=>o.maxSize),L=c(o=>o.setOffset),A=c(o=>o.setFilters),O=c(o=>o.setSorters),$=c(o=>o.setLimit),B=c(o=>o.resetPagination),H=c(o=>o.setCustomQueryObject),K=c(o=>o.customQuery),Q=c(o=>o.tablesSchema),{selectedRowObject:X,setSelectedRowObject:V,setIsInserting:Y,handleCloseEdit:ae}=W(),[fe,Pe]=n.useState(!0);n.useEffect(()=>(s.current=new Worker(new URL("/assets/sqliteWorker--AKdJmbk.js",import.meta.url),{type:"module"}),s.current.onmessage=o=>{var C,P,M;const j=o.data,{action:S}=j;if(S==="initComplete"){const{payload:f}=j;a(f.tableSchema),l(f.indexSchema),r(f.currentTable),d(f.tableSchema[f.currentTable].schema.map(E=>E.name)),A(null),O(null),V(null),Y(!1),L(0),x(!1)}else if(S==="queryComplete"){const{payload:f}=j;h(f.maxSize);const E=f.results;if(!E){m(null);return}const z=((C=E[0])==null?void 0:C.values)||[];z.length!==0?m(z):m(null),p(!1)}else if(S==="customQueryComplete"){const{payload:f}=j,E=f.results;if(!E){m(null);return}const z=((P=E[0])==null?void 0:P.values)||[];z.length!==0?H({data:z,columns:((M=E[0])==null?void 0:M.columns)||[]}):H(null),p(!1),g(null)}else if(S==="updateInstance"){const{payload:f}=j;a(f.tableSchema),l(f.indexSchema),p(!1),g(null),I.success("Database schema updated successfully")}else if(S==="updateComplete"){const{payload:f}=j;g(null),ae(),I.success(`Row ${f.type} successfully`)}else if(S==="insertComplete")g(null),ae(),I.success("Row inserted successfully");else if(S==="downloadComplete"){const{payload:f}=j,E=new Blob([f.bytes],{type:"application/octet-stream"}),z=URL.createObjectURL(E),k=document.createElement("a");k.href=z,k.download="database.sqlite",k.click(),I.success("Database downloaded successfully")}else if(S==="exportComplete"){const{payload:f}=j,E=new Blob([f.results],{type:"text/csv"}),z=URL.createObjectURL(E),k=document.createElement("a");k.href=z,k.download="export.csv",k.click(),I.success("Database exported successfully")}else if(S==="queryError"){const{payload:f}=j;console.error("Worker error:",f.error),p(!1),f.error.isCustomQueryError?(g(f.error.message),I.error(f.error.message)):I.error(f.error.message)}else console.warn("Unknown action:",S)},x(!0),s.current.postMessage({action:"init"}),()=>{var o;(o=s.current)==null||o.terminate()}),[d,L,x,a,r,l,H,m,h,p,g,A,O,V,ae,Y]),n.useEffect(()=>{if(!w)return;const o=setTimeout(()=>{var f,E,z,k;if(!s.current){I.error("Worker is not initialized");return}p(!0);let j=50;const S=(f=document.getElementById("tableHeader"))==null?void 0:f.getBoundingClientRect().height,C=(E=document.getElementById("dataSection"))==null?void 0:E.getBoundingClientRect().height,P=(z=document.getElementById("tableCell"))==null?void 0:z.getBoundingClientRect().height,M=(k=document.getElementById("paginationControls"))==null?void 0:k.getBoundingClientRect().height;fe?(Pe(!1),C&&M&&(j=Math.floor((C-M-51.5)/33))):S&&C&&M&&P&&(j=Math.floor((C-S-M)/P)),$(j),s.current.postMessage({action:"getTableData",payload:{currentTable:w,filters:i,sorters:b,limit:j,offset:y}})},100);return()=>clearTimeout(o)},[w,i,b,fe,y,$,p]);const Me=n.useCallback(o=>{var C;const j=(C=o.target.files)==null?void 0:C[0];if(!j){I.error("No file selected");return}I.info("Opening database");const S=new FileReader;S.onload=P=>{var f;const M=(f=P.target)==null?void 0:f.result;if(!s.current){I.error("Worker is not initialized");return}s.current.postMessage({action:"openFile",payload:{file:M}})},S.readAsArrayBuffer(j)},[]),Fe=n.useCallback(()=>{if(!s.current){I.error("Worker is not initialized");return}s.current.postMessage({action:"download"})},[]),Be=n.useCallback(o=>{A(null),O(null),B(),h(0),V(null),Y(!1),r(o),d(Q[o].schema.map(j=>j.name))},[A,O,B,h,r,V,Y,Q,d]),Ue=n.useCallback((o,j)=>{const C={...c.getState().filters||{},[o]:j};A(C),B()},[A,B]),He=n.useCallback(o=>{const C=((c.getState().sorters||{})[o]||"asc")==="asc"?"desc":"asc",P={[o]:C};O(P)},[O]),Qe=n.useCallback(o=>{const j=c.getState().offset;typeof o=="number"?L(o):o==="next"?L(j+u):o==="prev"?L(j-u):o==="first"?L(0):o==="last"&&L(T-u),V(null)},[T,u,L,V]),Ve=n.useCallback(o=>{if(!s.current){I.error("Worker is not initialized");return}s.current.postMessage({action:"export",payload:{table:w,offset:y,limit:u,filters:i,sorters:b,exportType:o}})},[w,i,b,y,u]),_e=n.useCallback(()=>{if(!s.current){I.error("Worker is not initialized");return}const o=K;if(!o)return;const S=o.replace(/--.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").split(";").map(C=>C.trim()).filter(C=>C!=="");for(const C of S)p(!0),s.current.postMessage({action:"exec",payload:{query:C,currentTable:w,filters:i,sorters:b,limit:u,offset:y}})},[w,i,b,u,y,p,K]),Ge=n.useCallback(o=>{if(!s.current){I.error("Worker is not initialized");return}p(!0),s.current.postMessage({action:o,payload:{table:w,columns:c.getState().columns,values:R.getState().editValues,primaryValue:X==null?void 0:X.primaryValue}}),s.current.postMessage({action:"refresh",payload:{currentTable:w,offset:y,limit:u,filters:i,sorters:b}})},[w,i,b,y,u,p,X]),We={workerRef:s,handleFileChange:Me,handleDownload:Fe,handleTableChange:Be,handleQueryFilter:Ue,handleQuerySorter:He,handlePageChange:Qe,handleExport:Ve,handleQueryExecute:_e,handleEditSubmit:Ge};return e.jsx(Ee.Provider,{value:We,children:t})},F=()=>{const t=n.useContext(Ee);if(t===void 0)throw new Error("useDatabaseWorker must be used within a DatabaseWorkerProvider");return t};function v(...t){return jt(gt(t))}const ls=n.memo(function({className:s,...a}){return e.jsx(Xe,{"data-slot":"tabs",className:v("flex flex-col",s),...a})});function os({className:t,...s}){return e.jsx(Ze,{"data-slot":"tabs-list",className:v("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}const re=ce.memo(function({className:s,...a}){return e.jsx(Ye,{"data-slot":"tabs-trigger",className:v("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}),ne=ce.memo(function({className:s,...a}){return e.jsx(Je,{"data-slot":"tabs-content",className:v("flex-1 outline-none",s),...a})}),is=Nt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),cs=({className:t,variant:s,size:a,asChild:l=!1,onClick:r,...m})=>{const d=l?et:"button",h=n.useCallback(p=>{r&&r(p)},[r]),x=n.useMemo(()=>v(is({variant:s,size:a,className:t})),[s,a,t]);return e.jsx(d,{"data-slot":"button",className:x,onClick:h,...m})},N=n.memo(cs),ds=({className:t,type:s,...a})=>e.jsx("input",{type:s,"data-slot":"input",className:v("border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex h-5 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a}),se=n.memo(ds);function ms(){const{theme:t,setTheme:s}=Ce();return e.jsx(N,{variant:"outline",size:"sm",onClick:()=>s(t==="dark"?"light":"dark"),"aria-label":t==="dark"?"Switch to light mode":"Switch to dark mode",title:t==="dark"?"Switch to light mode":"Switch to dark mode",className:"relative flex items-center justify-center transition-transform duration-300",children:t==="dark"?e.jsx(vt,{className:"h-[1.2rem] w-[1.2rem]"}):e.jsx(wt,{className:"h-[1.2rem] w-[1.2rem]"})})}const us=()=>{const{handleFileChange:t,handleDownload:s}=F();return e.jsxs("header",{className:"flex items-center justify-between gap-1 border-b p-1",children:[e.jsxs("section",{className:"flex w-full items-center gap-1",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative w-full cursor-pointer md:w-[300px]",children:[e.jsx(se,{id:"file-upload",type:"file",className:"absolute inset-0 cursor-pointer opacity-0",onChange:t}),e.jsxs(N,{size:"sm",variant:"outline",className:"w-full text-xs",children:[e.jsx(je,{className:"h-3 w-3"}),"Open Database"]})]}),e.jsxs(N,{size:"sm",variant:"outline",className:"text-xs",onClick:s,title:"Save the database",children:[e.jsx(yt,{className:"h-3 w-3"}),"Save Database"]})]}),e.jsx("a",{href:"https://github.com/vwh/sqlite-online",target:"_blank",rel:"noreferrer",children:e.jsx(N,{size:"sm",variant:"outline",className:"text-xs",title:"Source Code",children:e.jsx(St,{className:"h-3 w-3"})})}),e.jsx(ms,{})]})},xe=de(t=>({expandedTables:[],expandedTableSection:!0,expandedIndexSection:!0,toggleTable:s=>t(a=>({expandedTables:a.expandedTables.includes(s)?a.expandedTables.filter(l=>l!==s):[...a.expandedTables,s]})),toggleTableSection:()=>t(s=>({expandedTableSection:!s.expandedTableSection})),toggleIndexSection:()=>t(s=>({expandedIndexSection:!s.expandedIndexSection})),expandAllTables:s=>t({expandedTables:Object.keys(s)}),collapseAllTables:()=>t({expandedTables:[]})})),D=n.memo(function({children:s,className:a}){return e.jsx("span",{className:`block max-w-80 overflow-hidden text-ellipsis ${a??""}`,children:s})}),xs={DATE:/DATE|TIMESTAMP/i,BLOB:/^BLOB$/i,TEXT:/CHAR|TEXT|CLOB|VARCHAR/i,INTEGER:/INT/i,REAL:/REAL|FLOAT|DOUBLE|DECIMAL/i,NUMERIC:/NUMERIC/i,BOOLEAN:/BOOL/i},U=(t,s)=>xs[s].test(t),Ie=t=>U(t,"DATE"),hs=t=>U(t,"BLOB"),Le=t=>U(t,"TEXT"),ps=t=>U(t,"NUMERIC"),fs=t=>U(t,"BOOLEAN"),bs=t=>U(t,"INTEGER"),gs=t=>U(t,"REAL"),ze=t=>bs(t)||gs(t)||ps(t),js=n.memo(Ct),Ns=n.memo(Tt),vs=n.memo(Et),ws=n.memo(It),ys=n.memo(Lt),Ss=n.memo(zt),Cs=n.memo(Rt),Ts=n.memo(kt),he=n.memo(({columnSchema:t})=>{if(!t)return null;const{type:s,isPrimaryKey:a,isForeignKey:l}=t;let r=null;return s&&(r=hs(s)?e.jsx(vs,{className:"h-4 w-4 text-green-500"}):Ie(s)?e.jsx(ws,{className:"h-4 w-4 text-blue-500"}):Le(s)?e.jsx(ys,{className:"h-4 w-4 text-indigo-500"}):ze(s)?e.jsx(Ss,{className:"h-4 w-4 text-red-500"}):fs(s)?e.jsx(Cs,{className:"h-4 w-4 text-pink-500"}):e.jsx(Ts,{className:"h-4 w-4 text-gray-500"})),e.jsxs("div",{className:"flex items-center gap-[2px]",children:[a&&e.jsx(js,{className:"h-4 w-4 text-yellow-500"}),l&&e.jsx(Ns,{className:"h-4 w-4 text-purple-500"}),r]})}),Es=n.memo(({columnSchema:t})=>e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{columnSchema:t}),e.jsx("span",{className:"text-primary/60 ml-1 text-xs",children:t.name})]}),e.jsx(D,{className:"text-primary/60 text-xs whitespace-nowrap",children:t.type})]})),Is=n.memo(te),Ls=n.memo(Ne),Re=n.memo(({expanded:t,size:s=4})=>t?e.jsx(Is,{className:`h-${s} w-${s}`}):e.jsx(Ls,{className:`h-${s} w-${s}`})),zs=n.memo(({name:t,table:s})=>{const{expandedTables:a,toggleTable:l}=xe(),r=a.includes(t),m=()=>l(t),d=h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),l(t))};return e.jsxs("article",{children:[e.jsxs("div",{className:v("flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",r&&"ml-1"),onClick:m,onKeyDown:d,"aria-expanded":r,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(Re,{expanded:r})}),e.jsxs("span",{className:"flex items-center gap-1 capitalize",children:[e.jsx("span",{className:"text-sm",children:t}),e.jsxs("span",{className:"text-primary/50 text-xs",children:["(",s.schema.length,")"]})]})]}),r&&e.jsx("div",{className:"border-primary/20 mt-1 mb-2 ml-4 flex flex-col gap-1 space-y-0.5 border-l-2 pl-2",children:s.schema.map(h=>e.jsx(Es,{columnSchema:h},h.cid))})]})}),ke=n.memo(({title:t,expanded:s,icon:a,onToggle:l,children:r})=>{const m=d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),l())};return e.jsxs("header",{className:v("hover:bg-primary/5 bg-primary/7 flex cursor-pointer items-center px-2 py-2 transition-colors",!s&&"mb-0"),onClick:l,onKeyDown:m,"aria-expanded":s,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(Re,{expanded:s,size:5})}),a,e.jsx("span",{children:t}),r]})}),Rs=n.memo(({tablesSchema:t})=>{const{expandedTableSection:s,toggleTableSection:a,expandAllTables:l,collapseAllTables:r}=xe(),[m,d]=n.useState(!1),h=g=>{g.stopPropagation(),l(t),d(!0)},x=g=>{g.stopPropagation(),r(),d(!1)},p=s&&e.jsx("div",{className:"ml-auto flex",children:m?e.jsx(N,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:x,"aria-label":"Collapse all tables",children:e.jsx(Ot,{className:"h-4 w-4"})}):e.jsx(N,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:h,"aria-label":"Expand all tables",children:e.jsx(Pt,{className:"h-4 w-4"})})});return e.jsxs("section",{children:[e.jsx(ke,{title:"Tables",expanded:s,icon:e.jsx(je,{className:"mr-2 h-4 w-4"}),onToggle:a,children:p}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:Object.entries(t).map(([g,i])=>e.jsx(zs,{name:g,table:i},g))})]})}),ks=n.memo(({index:t})=>e.jsx("article",{children:e.jsx("div",{className:"flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[e.jsx("span",{className:"text-sm",children:t.name}),e.jsx(D,{className:"text-primary/60 text-xs font-medium whitespace-nowrap",children:t.tableName})]})})})),Ds=n.memo(({indexes:t})=>{const{expandedIndexSection:s,toggleIndexSection:a}=xe();return e.jsxs("section",{children:[e.jsx(ke,{title:"Indexes",expanded:s,icon:e.jsx(ve,{className:"mr-2 h-4 w-4"}),onToggle:a}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:t.map(l=>e.jsx(ks,{index:l},l.name))})]})}),As=n.memo(({onFilterChange:t})=>e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"text-primary/40 absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2 transform"}),e.jsx(se,{placeholder:"Search tables and indexes",className:"border-primary/20 h-8 w-full pl-8 text-sm text-[0.8rem]!",onChange:s=>t(s.target.value),"aria-label":"Search tables and indexes"})]})),Os=n.memo(({tableCount:t,indexCount:s})=>e.jsxs("footer",{className:"bg-primary/5 text-primary/60 flex items-center justify-between gap-2 border-t p-2 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(At,{className:"mr-1 h-3 w-3 text-wrap"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[t," Tables"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{className:"mr-1 h-3 w-3"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[s," Indexes"]})]})]})),pe=()=>{const[t,s]=n.useState(""),a=c(d=>d.tablesSchema),l=c(d=>d.indexesSchema),r=n.useMemo(()=>{if(!t)return a;const d={};for(const[h,x]of Object.entries(a))h.toLowerCase().includes(t.toLowerCase())&&(d[h]=x);return d},[a,t]),m=n.useMemo(()=>t?l.filter(d=>d.name.toLowerCase().includes(t.toLowerCase())||d.tableName.toLowerCase().includes(t.toLowerCase())):l,[l,t]);return e.jsxs("main",{className:"flex h-full w-full flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-primary/5 border-b p-2",children:e.jsx(As,{onFilterChange:s})}),e.jsxs("nav",{className:"flex-1 overflow-auto",children:[e.jsx(Rs,{tablesSchema:r}),l.length>0&&e.jsx(Ds,{indexes:m})]}),e.jsx(Os,{tableCount:Object.keys(a).length,indexCount:l.length})]})},Ps=()=>e.jsx("div",{className:"flex h-full flex-col",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(pe,{})})})});function le({className:t,...s}){return e.jsx($t,{"data-slot":"resizable-panel-group",className:v("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...s})}function _(t){return e.jsx(Kt,{"data-slot":"resizable-panel",...t})}function oe({withHandle:t,className:s,...a}){return e.jsx(qt,{"data-slot":"resizable-handle",className:v("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",s),...a,children:t&&e.jsx("div",{className:"bg-border border-primary/20 z-50 flex h-9 w-4 items-center justify-center rounded-xs border",children:e.jsx(Mt,{className:"size-2.5"})})})}function Ms({...t}){return e.jsx(st,{"data-slot":"select",...t})}function Fs({...t}){return e.jsx(nt,{"data-slot":"select-value",...t})}function Bs({className:t,children:s,...a}){return e.jsxs(at,{"data-slot":"select-trigger",className:v("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a,children:[s,e.jsx(rt,{asChild:!0,children:e.jsx(te,{className:"size-4 opacity-50"})})]})}function Us({className:t,children:s,position:a="popper",...l}){return e.jsx(lt,{children:e.jsxs(ot,{"data-slot":"select-content",className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...l,children:[e.jsx(Qs,{}),e.jsx(it,{className:v("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(Vs,{})]})})}function Hs({className:t,children:s,...a}){return e.jsxs(ct,{"data-slot":"select-item",className:v("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(dt,{children:e.jsx(Bt,{className:"size-4"})})}),e.jsx(mt,{children:s})]})}const Qs=ce.memo(function({className:s,...a}){return e.jsx(tt,{"data-slot":"select-scroll-up-button",className:v("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ft,{className:"size-4"})})});function Vs({className:t,...s}){return e.jsx(ut,{"data-slot":"select-scroll-down-button",className:v("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(te,{className:"size-4"})})}const _s=()=>{const{handleTableChange:t}=F(),s=c(r=>r.tablesSchema),a=c(r=>r.currentTable);return n.useMemo(()=>e.jsxs(Ms,{onValueChange:t,value:a||void 0,children:[e.jsx(Bs,{className:"border-primary/20 h-8 w-30 border text-sm sm:w-48",children:e.jsx(Fs,{placeholder:"Select Table"})}),e.jsx(Us,{children:Object.keys(s).map(r=>e.jsx(Hs,{value:r,children:e.jsx(D,{className:"text-[0.8rem]! capitalize",children:r})},r))})]}),[s,a,t])};function Gs({...t}){return e.jsx(xt,{"data-slot":"dropdown-menu",...t})}function Ws({...t}){return e.jsx(ht,{"data-slot":"dropdown-menu-trigger",...t})}function $s({className:t,sideOffset:s=4,...a}){return e.jsx(pt,{children:e.jsx(ft,{"data-slot":"dropdown-menu-content",sideOffset:s,className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...a})})}function q({className:t,inset:s,variant:a="default",...l}){return e.jsx(bt,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":a,className:v("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l})}const Ks=()=>{const{handleExport:t}=F(),{isInserting:s,handleInsert:a}=W(),l=c(x=>x.filters),r=c(x=>x.setFilters),m=c(x=>x.sorters),d=c(x=>x.setSorters);return n.useMemo(()=>e.jsxs(Gs,{children:[e.jsx(Ws,{asChild:!0,children:e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 text-xs",children:["Actions ",e.jsx(te,{className:"ml-1 h-3 w-3"})]})}),e.jsxs($s,{className:"w-40",children:[e.jsx(q,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>r(null),disabled:l==null,title:"Clear applied filters",children:[e.jsx(me,{className:"mr-1 h-3 w-3"}),"Clear filters"]})}),e.jsx(q,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>d(null),disabled:m==null,title:"Reset sorting",children:[e.jsx(we,{className:"mr-1 h-3 w-3"}),"Reset sorting"]})}),e.jsx(q,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:a,disabled:s,title:"Insert a new row",children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]})}),e.jsx(q,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("table"),title:"Export the current table as CSV",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),"Export table"]})}),e.jsx(q,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("current"),title:"Export the current data as CSV",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),"Export data"]})})]})]}),[l,m,t,a,s,r,d])};function qs({className:t,...s}){return e.jsx("textarea",{"data-slot":"textarea",className:v("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}const Xs=()=>{const{handleEditSubmit:t}=F(),{selectedRowObject:s,isInserting:a,handleCloseEdit:l}=W(),r=R(u=>u.editValues),m=R(u=>u.setEditValues),d=c(u=>u.tablesSchema),h=c(u=>u.currentTable),x=c(u=>u.columns);n.useEffect(()=>{a?m((x==null?void 0:x.map(()=>""))||[]):s&&m(s.data.map(u=>(u==null?void 0:u.toString())??""))},[a,s,x,m]);const p=n.useCallback((u,y)=>{const w=R.getState().editValues;m(w.map((T,L)=>L===u?y:T))},[m]),g=n.useMemo(()=>{var y;if(!x||!h||!d[h])return null;const u=(y=d[h])==null?void 0:y.schema;return x.map((w,T)=>{var L,A,O,$,B,H,K;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:w,className:"bg-primary/5 flex items-center gap-1 rounded-sm p-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{columnSchema:u[T]}),e.jsx(D,{className:"text-xs font-medium capitalize",children:w})]}),e.jsx("span",{className:"text-primary/50 text-xs",children:u[T].IsNullable&&"Nullable"})]})}),Le(((L=u[T])==null?void 0:L.type)||"")?e.jsx(qs,{id:w,name:w,className:"border-primary/20 rounded-none text-sm text-[0.8rem]!",value:r[T]||"",onChange:Q=>p(T,Q.target.value),placeholder:((O=(A=d[h])==null?void 0:A.schema[T])==null?void 0:O.dflt_value)||"Null"}):e.jsx(se,{id:w,name:w,type:ze((($=u[T])==null?void 0:$.type)||"")?"number":Ie(((B=u[T])==null?void 0:B.type)||"")?"date":"text",className:"border-primary/20 h-8 rounded-none text-sm text-[0.8rem]!",value:r[T]||"",onChange:Q=>p(T,Q.target.value),placeholder:((K=(H=d[h])==null?void 0:H.schema[T])==null?void 0:K.dflt_value)||"Null"})]},w)})},[x,h,d,r,p]),i=n.useMemo(()=>e.jsxs("div",{className:"flex w-full",children:[e.jsx(N,{size:"sm",variant:"outline",className:"w-full text-xs",onClick:()=>t(a?"insert":"update"),"aria-label":a?"Insert row":"Apply changes",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"mr-1 h-3 w-3"}),"Apply changes"]})}),!a&&e.jsx(N,{size:"sm",variant:"destructive",className:"rounded-none text-xs",onClick:()=>t("delete"),"aria-label":"Delete row",children:e.jsx(Ut,{className:"h-2 w-2"})})]}),[t,a]),b=n.useMemo(()=>e.jsxs("div",{className:"bg-primary/5 flex w-full items-center justify-between gap-1 border-b p-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(D,{className:"whitespace-nowrap",children:"Inserting row"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx(D,{className:"whitespace-nowrap",children:"Updating row"})]})}),e.jsx(N,{size:"sm",variant:"outline",className:"text-xs",onClick:l,title:"Go back to data","aria-label":"Go back to data",children:e.jsx(ye,{className:"h-3 w-3"})})]}),[a,l]);return e.jsx("section",{className:"h-full overflow-auto",children:e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsxs("div",{className:"overflow-auto",children:[b,g]}),i]})})},De=n.memo(function({className:s,...a}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:v("w-full caption-bottom text-sm",s),...a})})}),Ae=n.memo(function({className:s,...a}){return e.jsx("thead",{"data-slot":"table-header",id:"tableHeader",className:v("[&_tr]:border-b",s),...a})}),Oe=n.memo(function({className:s,...a}){return e.jsx("tbody",{"data-slot":"table-body",className:v("[&_tr:last-child]:border-0",s),...a})});n.memo(function({className:s,...a}){return e.jsx("tfoot",{"data-slot":"table-footer",className:v("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",s),...a})});const G=n.memo(function({className:s,...a}){return e.jsx("tr",{"data-slot":"table-row",className:v("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...a})}),ie=n.memo(function({className:s,...a}){return e.jsx("th",{"data-slot":"table-head",className:v("text-muted-foreground min-h-6 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),ee=n.memo(function({className:s,...a}){return e.jsx("td",{"data-slot":"table-cell",id:"tableCell",className:v("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),Ys=n.memo(({column:t,value:s,onChange:a})=>{const l=n.useCallback(r=>a(t,r.target.value),[t,a]);return e.jsx(se,{type:"text",className:"border-primary/20 max-h-6 w-full rounded px-2 py-1 text-[0.8rem]!",value:s,onChange:l,placeholder:"Filter"})}),Js=n.memo(Ht),Zs=n.memo(Qt),ea=n.memo(Vt),ta=n.memo(({column:t})=>{const s=c(l=>l.sorters),{handleQuerySorter:a}=F();return e.jsx(e.Fragment,{children:s!=null&&s[t]?s[t]==="asc"?e.jsx("button",{title:"Sort column in descending order",type:"button","aria-label":"Sort Descending",onClick:()=>a(t),children:e.jsx(ea,{className:"h-3 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Ascending",onClick:()=>a(t),children:e.jsx(Zs,{className:"h-3 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Column",onClick:()=>a(t),children:e.jsx(Js,{className:"h-3 w-3"})})})}),sa=()=>{const t=c(i=>i.data),s=c(i=>i.columns),a=c(i=>i.currentTable),l=c(i=>i.tablesSchema),r=c(i=>i.filters),m=c(i=>i.setFilters),{handleQueryFilter:d}=F(),{handleRowClick:h,selectedRowObject:x}=W(),p=n.useMemo(()=>e.jsx("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:r?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-md font-medium",children:"No Data To Show For Current Filters"}),e.jsxs(N,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>m(null),children:[e.jsx(me,{className:"mr-1 h-3 w-3"}),"Clear filters"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-md font-medium",children:"No Data To Show"}),e.jsx("p",{className:"text-sm",children:"This table does not have any data to display"})]})}),[r,m]),g=n.useMemo(()=>(s||[]).map(i=>e.jsx(Ys,{column:i,value:(r==null?void 0:r[i])||"",onChange:d},i)),[s,r,d]);return n.useMemo(()=>e.jsxs(De,{children:[e.jsx(Ae,{children:e.jsx(G,{className:"bg-primary/5",children:s&&a?s.map((i,b)=>e.jsxs(ie,{className:"p-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 py-[1.5px]",children:[e.jsx(ta,{column:i}),e.jsx(D,{className:"text-foreground font-medium capitalize",children:i}),e.jsx(he,{columnSchema:l[a].schema[b]})]}),g==null?void 0:g[b]]},i)):e.jsx(ie,{children:e.jsx("p",{className:"text-xs",children:"No columns found"})})})}),e.jsx(Oe,{children:t&&t.length>0?t.map((i,b)=>{const u=i.slice(1);return e.jsx(G,{onClick:()=>h(u,b,i[0]),className:`hover:bg-primary/5 cursor-pointer text-xs ${(x==null?void 0:x.index)===b?"bg-primary/5":""}`,children:u.map((y,w)=>{var T;return e.jsx(ee,{className:"p-2",children:y?e.jsx(e.Fragment,{children:((T=l[a].schema[w])==null?void 0:T.type)==="BLOB"?e.jsx("span",{className:"text-muted-foreground italic",children:"BLOB"}):e.jsx(D,{children:y})}):e.jsx("span",{className:"text-muted-foreground italic",children:y===null?"NULL":JSON.stringify(y)})},w)})},b)}):e.jsx(G,{children:e.jsx(ee,{colSpan:(s==null?void 0:s.length)||1,className:"h-32 text-center",children:p})})})]}),[t,s,a,l,h,x,p,g])},aa=()=>{const{handlePageChange:t,handleExport:s}=F(),{isInserting:a,handleInsert:l}=W(),r=c(p=>p.offset),m=c(p=>p.limit),d=c(p=>p.maxSize),h=c(p=>p.isDataLoading);return n.useMemo(()=>e.jsxs("footer",{className:"bg-background flex w-full items-center justify-between border-t",id:"paginationControls",children:[e.jsxs("section",{className:"bg-primary/10 flex grow items-center gap-1 p-2",children:[e.jsx(N,{onClick:()=>t("first"),disabled:r===0||h,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the first data",children:e.jsx(_t,{className:"h-4 w-4"})}),e.jsx(N,{onClick:()=>t("prev"),disabled:r===0||h,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the previous data",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-2 text-xs whitespace-nowrap",children:[r+1," -> ",r+m>d?d:r+m," of ",d]}),e.jsx(N,{onClick:()=>t("next"),disabled:r+m>=d||h,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the next data",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(N,{onClick:()=>t("last"),disabled:r+m>=d||h,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the last data",children:e.jsx(Gt,{className:"h-4 w-4"})})]}),e.jsxs("section",{className:"bg-primary/10 hidden items-center gap-1 p-2 md:flex",children:[e.jsxs(N,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:l,disabled:a,children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}),e.jsxs(N,{onClick:()=>s("current"),size:"sm",variant:"outline",className:"h-7 text-xs",title:"Export current data as CSV",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),"Export data"]})]})]}),[d,t,h,s,a,r,m,l])},ra=n.memo(()=>{const t=c(u=>u.filters),s=c(u=>u.sorters),a=c(u=>u.setFilters),l=c(u=>u.setSorters),r=c(u=>u.isDataLoading),m=c(u=>u.isDatabaseLoading),d=R(u=>u.dataPanelSize),h=R(u=>u.schemaPanelSize),x=R(u=>u.setDataPanelSize),p=R(u=>u.setSchemaPanelSize),{handleExport:g}=F(),{isEditing:i}=W(),b=n.useMemo(()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden items-center gap-1 md:flex",children:[e.jsxs(N,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>a(null),disabled:t==null,title:"Clear applied filters",children:[e.jsx(me,{className:"mr-1 h-3 w-3"}),"Clear filters"]}),e.jsxs(N,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>l(null),disabled:s==null,title:"Reset sorting",children:[e.jsx(we,{className:"mr-1 h-3 w-3"}),"Reset sorting"]}),e.jsxs(N,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>g("table"),title:"Export the current table as CSV",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),"Export table"]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(Ks,{})})]}),[t,s,a,l,g]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsx(_s,{}),b,(r||m)&&e.jsx(na,{text:"Loading data"})]}),e.jsx("div",{className:"relative h-full overflow-hidden",children:e.jsxs(le,{direction:"horizontal",className:"h-full",children:[e.jsx(_,{id:"dataPanel",defaultSize:d,onResize:x,children:e.jsxs("div",{className:"flex h-full flex-col justify-between border-l",id:"dataSection",children:[e.jsx(sa,{}),e.jsx(aa,{})]})}),e.jsx(oe,{className:"hidden md:flex",withHandle:!0}),e.jsxs(_,{id:"schemaPanel",defaultSize:h,onResize:p,className:`static md:relative md:block ${i?"block":"hidden"}`,children:[e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(pe,{})})}),e.jsx("div",{className:`bg-background absolute top-0 right-0 z-40 h-full w-full ${i?"block":"hidden"}`,children:e.jsx("section",{className:"bg-primary/5 h-full",children:e.jsx(Xs,{})})})]})]})})]})}),na=({text:t})=>e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(ue,{className:"mr-1 h-3 w-3 animate-spin"}),t]}),la=["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"],oa=["ABS","ACOS","ASIN","ATAN","CEIL","COS","EXP","FLOOR","HEX","LENGTH","LOG","LOWER","LTRIM","OCT","PI","POW","ROUND","SIGN","SIN","SQRT","TAN","TRIM","UPPER"];function ia(){const{theme:t}=Ce(),s=c(i=>i.customQuery),a=c(i=>i.setCustomQuery),l=c(i=>i.tablesSchema),r=n.useRef([]),{tableNames:m,columnNames:d}=n.useMemo(()=>{const i=Object.keys(l),b=i.flatMap(u=>l[u].schema.map(y=>y.name));return{tableNames:i,columnNames:b}},[l]),h=n.useMemo(()=>((!r.current||m.length!==r.current.length)&&(r.current=[...la.map(i=>({label:i,type:"keyword"})),...oa.map(i=>({label:i,type:"function"})),...m.map(i=>({label:i,type:"table"})),...d.map(i=>({label:i,type:"column"}))]),r.current),[m,d]),x=n.useCallback(i=>{const b=i.matchBefore(/\w*/);return!b||b.from===b.to&&!i.explicit?null:{from:b.from,to:b.to,options:h}},[h]),p=n.useCallback(i=>{i!==s&&a(i)},[s,a]),g=n.useMemo(()=>[Jt,Zt(),es({override:[x]})],[x]);return e.jsx(Xt,{value:s,height:"100%",extensions:g,onChange:p,className:"h-full w-full",theme:t==="dark"?Yt:"light"})}const ca=()=>{const t=c(s=>s.customQueryObject);return n.useMemo(()=>e.jsx(e.Fragment,{children:t?e.jsxs(De,{children:[e.jsx(Ae,{children:e.jsx(G,{className:"bg-primary/5",children:t.columns.map(s=>e.jsx(ie,{className:"p-1 text-xs",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(D,{className:"text-foreground font-medium capitalize",children:s})})},s))})}),e.jsx(Oe,{children:t.data&&t.data.length>0?t.data.map((s,a)=>e.jsx(G,{className:"hover:bg-primary/5 text-xs",children:s.map((l,r)=>e.jsx(ee,{className:"p-2",children:l?e.jsx(D,{children:l}):e.jsx("span",{className:"text-muted-foreground italic",children:"NULL"})},r))},a)):e.jsx(G,{children:e.jsx(ee,{colSpan:t.columns.length||1,className:"h-32 text-center",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:[e.jsx("p",{className:"text-md whitespace-nowrap",children:"No Data To Show"}),e.jsx("p",{className:"text-sm whitespace-nowrap",children:"Seems like there is no data to display"})]})})})})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:[e.jsx("p",{className:"text-md whitespace-nowrap",children:"No Data To Show"}),e.jsx("p",{className:"text-sm whitespace-nowrap",children:"Execute a query to view data"})]})}),[t])},da=()=>{const t=c(x=>x.errorMessage),s=c(x=>x.isDataLoading),a=c(x=>x.isDatabaseLoading),l=R(x=>x.dataPanelSize),r=R(x=>x.schemaPanelSize),m=R(x=>x.setDataPanelSize),d=R(x=>x.setSchemaPanelSize),{handleQueryExecute:h}=F();return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsxs(N,{size:"sm",variant:"outline",className:"w-[150px] text-xs",onClick:h,title:"Execute SQL",children:[e.jsx(Wt,{className:"mr-1 h-3 w-3"}),"Execute SQL"]}),(s||a)&&e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(ue,{className:"mr-1 h-3 w-3 animate-spin"}),"Loading data"]})]}),e.jsx("div",{className:"h-full overflow-hidden",children:e.jsxs(le,{direction:"horizontal",className:"h-full",children:[e.jsx(_,{defaultSize:l,onResize:m,children:e.jsxs(le,{direction:"vertical",children:[e.jsxs(_,{defaultSize:25,children:[t&&e.jsx("div",{className:"p-2 text-sm text-red-400",children:t}),e.jsx(ia,{})]}),e.jsx(oe,{withHandle:!0}),e.jsx(_,{defaultSize:75,children:e.jsx("div",{className:"flex h-full flex-col justify-between border",children:e.jsx(ca,{})})})]})}),e.jsx(oe,{className:"hidden md:flex",withHandle:!0}),e.jsx(_,{defaultSize:r,onResize:d,className:"hidden md:block",children:e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(pe,{})})})})]})})]})};function ma(){const t=c(s=>s.isDatabaseLoading);return e.jsxs("main",{className:"bg-primary/5 flex h-screen flex-col overflow-hidden",children:[e.jsx(us,{}),e.jsxs(ls,{defaultValue:"data",className:"flex flex-1 flex-col",children:[e.jsxs(os,{className:"bg-primary/5 mt-2 h-9 w-full justify-start rounded-none border-b",children:[e.jsx(re,{id:"structure",disabled:t,value:"structure",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs",children:"Database Structure"},"structure"),e.jsx(re,{id:"data",disabled:t,value:"data",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs",children:"Browse Data"},"data"),e.jsx(re,{disabled:t,id:"execute",value:"execute",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs",children:"Execute SQL"},"execute")]}),e.jsxs("div",{className:"max-h-custom-dvh flex-1 overflow-hidden",children:[e.jsx(ne,{value:"data",className:"m-0 h-full border-none p-0",children:t?e.jsx(ua,{message:"Loading Database"}):e.jsx(ra,{})}),e.jsx(ne,{value:"structure",className:"m-0 h-full border-none p-0",children:e.jsx(Ps,{})}),e.jsx(ne,{value:"execute",className:"m-0 h-full border border-none p-0",children:e.jsx(da,{})})]})]})]})}const ua=({message:t})=>e.jsxs("div",{className:"flex h-full items-center justify-center",children:[e.jsx(ue,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-xl",children:t})]});$e.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsxs(as,{defaultTheme:"dark",storageKey:"ui-theme",children:[e.jsx(rs,{children:e.jsx(ns,{children:e.jsx(ma,{})})}),e.jsx(ts,{expand:!0})]})}));
