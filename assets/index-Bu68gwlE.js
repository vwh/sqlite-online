import{j as e,r,R as me}from"./react-g1wVjy4W.js";import{c as Ze}from"./react-dom-tIChXhgf.js";import{z as et}from"./next-themes-C1hNFtgU.js";import{T as tt,t as W}from"./sonner-BM5nqNKi.js";import{c as ue}from"./zustand-Dpr3jGQ2.js";import{l as Te}from"./lodash-BkzDGCz7.js";import{R as st,T as at,C as nt,L as rt,S as lt,a as ot,b as it,c as ct,I as dt,V as mt,P as ut,d as xt,e as ht,f as pt,g as ft,h as bt,i as gt,j as jt,k as vt,l as Nt,m as wt,n as St}from"./@radix-ui-Bg0YcXMc.js";import{c as yt}from"./clsx-B-dksMZM.js";import{t as Ct}from"./tailwind-merge-AdmevC4f.js";import{c as Tt}from"./class-variance-authority-Dp3B9jqt.js";import{S as Et,M as It,D as Ie,a as Rt,K as Lt,b as zt,C as Dt,c as kt,T as At,H as Pt,d as Mt,e as Ot,f as ee,g as Re,h as Le,i as Ft,j as Bt,k as Ut,l as Ht,G as Qt,m as Vt,n as Gt,F as xe,L as ze,P as J,o as K,p as Ee,q as _t,r as De,A as Wt,s as $t,t as Kt,u as qt,v as Xt,w as he,x as Yt}from"./lucide-react-CDPV4d2d.js";import{P as Jt,a as Zt,b as es}from"./react-resizable-panels-CXtWjGcq.js";import{R as ts,d as ss}from"./@uiw-UsqZQFQK.js";import{G as as,I as ns,r as rs}from"./@codemirror-BjKk2IdN.js";import"./scheduler-BNqrtbQi.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-CEOqnfOC.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-DWsGvYUB.js";import"./react-style-singleton-WVrfWbSK.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-JgbaGmrm.js";import"./use-callback-ref-D9jqOmh9.js";import"./@floating-ui-DRmULUd_.js";import"./@babel-Cv5OCJ0e.js";import"./@lezer-E7PapBHi.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();const ls=({...t})=>{const{theme:s="system"}=et();return e.jsx(tt,{theme:s,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})},os={theme:"system",setTheme:()=>null},ke=r.createContext(os);function is({children:t,defaultTheme:s="system",storageKey:a="vite-ui-theme",...o}){const[n,c]=r.useState(()=>localStorage.getItem(a)||s);r.useEffect(()=>{const x=window.document.documentElement;if(x.classList.remove("light","dark"),n==="system"){const f=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";x.classList.add(f);return}x.classList.add(n)},[n]);const m={theme:n,setTheme:x=>{localStorage.setItem(a,x),c(x)}};return e.jsx(ke.Provider,{...o,value:m,children:t})}const Ae=()=>{const t=r.useContext(ke);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},i=ue(t=>({tablesSchema:{},indexesSchema:[],currentTable:null,data:null,columns:null,maxSize:1,isDatabaseLoading:!1,isDataLoading:!1,errorMessage:null,filters:null,sorters:null,limit:50,offset:0,customQuery:void 0,customQueryObject:null,setTablesSchema:s=>t({tablesSchema:s}),setIndexesSchema:s=>t({indexesSchema:s}),setCurrentTable:s=>t({currentTable:s}),setData:s=>t({data:s}),setColumns:s=>t({columns:s}),setMaxSize:s=>t({maxSize:s}),setIsDatabaseLoading:s=>t({isDatabaseLoading:s}),setIsDataLoading:s=>t({isDataLoading:s}),setErrorMessage:s=>t({errorMessage:s}),setFilters:s=>t({filters:s}),setSorters:s=>t({sorters:s}),setLimit:s=>t({limit:s}),setOffset:s=>t({offset:s}),setCustomQuery:s=>t({customQuery:s}),setCustomQueryObject:s=>t({customQueryObject:s}),resetPagination:()=>t({offset:0}),resetFiltersAndSorters:()=>t({filters:null,sorters:null})})),T=ue((t,s)=>{const a=Te.debounce(n=>{t({schemaPanelSize:n})},200),o=Te.debounce(n=>{t({dataPanelSize:n})},200);return{schemaPanelSize:0,dataPanelSize:100,topPanelSize:0,bottomPanelSize:100,query:"",editValues:[],selectedRow:null,isInserting:!1,isMobile:window.matchMedia("(max-width: 768px)").matches,setSchemaPanelSize:a,setDataPanelSize:o,setQuery:n=>t({query:n}),setEditValues:n=>t({editValues:n}),setSelectedRow:n=>t({selectedRow:n}),setIsInserting:n=>t({isInserting:n}),setIsMobile:n=>t({isMobile:n}),resetEditSection:()=>t(()=>({isInserting:!1,selectedRow:null})),setPanelsForDevice:()=>t(()=>s().isMobile?{schemaPanelSize:0,dataPanelSize:100}:{schemaPanelSize:25,dataPanelSize:75})}}),Pe=r.createContext(void 0),cs=({children:t})=>{const s=T(v=>v.setPanelsForDevice),[a,o]=r.useState(null),[n,c]=r.useState(!1),m=a!==null||n;r.useEffect(()=>{s()},[s]);const x=r.useCallback((v,d)=>{c(!1),o({data:v,index:d})},[]),f=r.useCallback(()=>{o(null),c(!0)},[]),u=r.useCallback(()=>{c(!1),o(null)},[]),h=r.useCallback(()=>{c(!1),o(null)},[]),p={handleRowClick:x,handleInsert:f,handlePanelReset:u,isEditing:m,selectedRowObject:a,isInserting:n,setIsInserting:c,setSelectedRowObject:o,handleCloseEdit:h};return e.jsx(Pe.Provider,{value:p,children:t})},Q=()=>{const t=r.useContext(Pe);if(t===void 0)throw new Error("usePanelManager must be used within a PanelProvider");return t},Me=r.createContext(void 0),ds=({children:t})=>{const s=r.useRef(null),a=i(l=>l.setTablesSchema),o=i(l=>l.setIndexesSchema),n=i(l=>l.setCurrentTable),c=i(l=>l.setData),m=i(l=>l.setColumns),x=i(l=>l.setMaxSize),f=i(l=>l.setIsDatabaseLoading),u=i(l=>l.setIsDataLoading),h=i(l=>l.setErrorMessage),p=i(l=>l.filters),v=i(l=>l.sorters),d=i(l=>l.limit),S=i(l=>l.offset),w=i(l=>l.currentTable),M=i(l=>l.maxSize),L=i(l=>l.setOffset),O=i(l=>l.setFilters),F=i(l=>l.setSorters),ge=i(l=>l.setLimit),q=i(l=>l.resetPagination),se=i(l=>l.setCustomQueryObject),je=i(l=>l.customQuery),ve=i(l=>l.tablesSchema),ae=T(l=>l.resetEditSection),{selectedRowObject:X,setSelectedRowObject:B,setIsInserting:Y,handleCloseEdit:ne}=Q(),[Ne,Qe]=r.useState(!0);r.useEffect(()=>(s.current=new Worker(new URL("/assets/sqliteWorker-Dl-dv9J5.js",import.meta.url),{type:"module"}),s.current.onmessage=l=>{var y,C,I,z,D,V,G,_,we,Se,ye,Ce;const{action:b,payload:g}=l.data;if(b==="initComplete")a(g.tableSchema),o(g.indexSchema),n(g.currentTable),m((C=(y=g.tableSchema[g.currentTable])==null?void 0:y.schema)==null?void 0:C.map(k=>k.name)),O(null),F(null),B(null),Y(!1),f(!1);else if(b==="queryComplete")x(g.maxSize),(((z=(I=g.results)==null?void 0:I[0])==null?void 0:z.values)||[]).length!==0?c(((V=(D=g.results)==null?void 0:D[0])==null?void 0:V.values)||[]):c(null),u(!1);else if(b==="customQueryComplete")(((_=(G=g.results)==null?void 0:G[0])==null?void 0:_.values)||[]).length!==0?se({data:((Se=(we=g.results)==null?void 0:we[0])==null?void 0:Se.values)||[],columns:((Ce=(ye=g.results)==null?void 0:ye[0])==null?void 0:Ce.columns)||[]}):se(null),u(!1),h(null);else if(b==="updateInstance")a(g.tableSchema),o(g.indexSchema),u(!1),h(null),W.success("Database schema updated successfully");else if(b==="updateComplete")h(null),ae(),ne(),W.success(`Row ${g.type} successfully`);else if(b==="insertComplete")h(null),ae(),ne(),W.success("Row inserted successfully");else if(b==="downloadComplete"){const k=new Blob([g.bytes],{type:"application/octet-stream"}),re=URL.createObjectURL(k),A=document.createElement("a");A.href=re,A.download="database.sqlite",A.click()}else if(b==="exportComplete"){const k=new Blob([g.results],{type:"text/csv"}),re=URL.createObjectURL(k),A=document.createElement("a");A.href=re,A.download="export.csv",A.click()}else b==="queryError"?(u(!1),console.error("Worker error:",g.error),g.error.isCustomQueryError?h(g.error.message):W.error(g.error.message)):console.warn("Unknown action:",b)},f(!0),s.current.postMessage({action:"init"}),()=>{var l;(l=s.current)==null||l.terminate()}),[m,f,a,n,o,se,c,x,u,h,O,F,ae,B,ne,Y]),r.useEffect(()=>{if(!w)return;const l=setTimeout(()=>{var z,D,V,G,_;u(!0);let b=50;const g=(z=document.getElementById("tableHeader"))==null?void 0:z.getBoundingClientRect().height,y=(D=document.getElementById("dataSection"))==null?void 0:D.getBoundingClientRect().height,C=(V=document.getElementById("tableCell"))==null?void 0:V.getBoundingClientRect().height,I=(G=document.getElementById("paginationControls"))==null?void 0:G.getBoundingClientRect().height;Ne?(Qe(!1),y&&I&&(b=Math.floor((y-I-51.5)/33))):g&&y&&I&&C&&(b=Math.floor((y-g-I)/C)),ge(b),(_=s.current)==null||_.postMessage({action:"getTableData",payload:{currentTable:w,filters:p,sorters:v,limit:b,offset:S}})},100);return()=>clearTimeout(l)},[w,p,v,Ne,S,ge,u]);const Ve=r.useCallback(l=>{var y;const b=(y=l.target.files)==null?void 0:y[0];if(!b)return;W.info("Opening database");const g=new FileReader;g.onload=C=>{var z,D;const I=(z=C.target)==null?void 0:z.result;(D=s.current)==null||D.postMessage({action:"openFile",payload:{file:I}})},g.readAsArrayBuffer(b)},[]),Ge=r.useCallback(()=>{var l;(l=s.current)==null||l.postMessage({action:"download"})},[]),_e=r.useCallback(l=>{O(null),F(null),q(),x(0),B(null),Y(!1),n(l),m(ve[l].schema.map(b=>b.name))},[O,F,q,x,n,B,Y,ve,m]),We=r.useCallback((l,b)=>{const y={...i.getState().filters||{},[l]:b};O(y),q()},[O,q]),$e=r.useCallback(l=>{const y=((i.getState().sorters||{})[l]||"asc")==="asc"?"desc":"asc",C={[l]:y};F(C)},[F]),Ke=r.useCallback(l=>{const b=i.getState().offset;typeof l=="number"?L(l):l==="next"?L(b+d):l==="prev"?L(b-d):l==="first"?L(0):l==="last"&&L(M-d),B(null)},[M,d,L,B]),qe=r.useCallback(l=>{var b;(b=s.current)==null||b.postMessage({action:"export",payload:{table:w,offset:S,limit:d,filters:p,sorters:v,exportType:l}})},[w,p,v,S,d]),Xe=r.useCallback(()=>{var y;const l=je;if(!l)return;const g=l.replace(/--.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").split(";").map(C=>C.trim()).filter(C=>C!=="");for(const C of g)u(!0),(y=s.current)==null||y.postMessage({action:"exec",payload:{query:C,currentTable:w,filters:p,sorters:v,limit:d,offset:S}})},[w,p,v,d,S,u,je]),Ye=r.useCallback(l=>{var b,g;u(!0),(b=s.current)==null||b.postMessage({action:l,payload:{table:w,columns:i.getState().columns,values:T.getState().editValues,whereValues:X==null?void 0:X.data}}),(g=s.current)==null||g.postMessage({action:"refresh",payload:{currentTable:w,offset:S,limit:d,filters:p,sorters:v}})},[w,p,v,S,d,u,X]),Je={workerRef:s,handleFileChange:Ve,handleDownload:Ge,handleTableChange:_e,handleQueryFilter:We,handleQuerySorter:$e,handlePageChange:Ke,handleExport:qe,handleQueryExecute:Xe,handleEditSubmit:Ye};return e.jsx(Me.Provider,{value:Je,children:t})},R=()=>{const t=r.useContext(Me);if(t===void 0)throw new Error("useDatabaseWorker must be used within a DatabaseWorkerProvider");return t};function N(...t){return Ct(yt(t))}const ms=r.memo(function({className:s,...a}){return e.jsx(st,{"data-slot":"tabs",className:N("flex flex-col",s),...a})});function us({className:t,...s}){return e.jsx(rt,{"data-slot":"tabs-list",className:N("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}const le=me.memo(function({className:s,...a}){return e.jsx(at,{"data-slot":"tabs-trigger",className:N("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}),oe=me.memo(function({className:s,...a}){return e.jsx(nt,{"data-slot":"tabs-content",className:N("flex-1 outline-none",s),...a})}),xs=Tt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),hs=({className:t,variant:s,size:a,asChild:o=!1,onClick:n,...c})=>{const m=o?lt:"button",x=r.useCallback(u=>{n&&n(u)},[n]),f=r.useMemo(()=>N(xs({variant:s,size:a,className:t})),[s,a,t]);return e.jsx(m,{"data-slot":"button",className:f,onClick:x,...c})},j=r.memo(hs),ps=({className:t,type:s,...a})=>e.jsx("input",{type:s,"data-slot":"input",className:N("border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a}),te=r.memo(ps);function fs(){const{theme:t,setTheme:s}=Ae();return e.jsx(j,{variant:"outline",size:"sm",onClick:()=>s(t==="dark"?"light":"dark"),"aria-label":t==="dark"?"Switch to light mode":"Switch to dark mode",title:t==="dark"?"Switch to light mode":"Switch to dark mode",className:"relative flex items-center justify-center transition-transform duration-300",children:t==="dark"?e.jsx(Et,{className:"h-[1.2rem] w-[1.2rem]"}):e.jsx(It,{className:"h-[1.2rem] w-[1.2rem]"})})}const bs=()=>{const{handleFileChange:t,handleDownload:s}=R();return e.jsxs("header",{className:"flex items-center justify-between gap-1 border-b p-1",children:[e.jsxs("section",{className:"flex w-full items-center gap-1",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative w-full cursor-pointer md:w-[300px]",children:[e.jsx(te,{id:"file-upload",type:"file",className:"absolute inset-0 cursor-pointer opacity-0",onChange:t}),e.jsxs(j,{size:"sm",variant:"outline",className:"w-full text-xs",children:[e.jsx(Ie,{className:"h-3 w-3"}),"Open Database"]})]}),e.jsxs(j,{size:"sm",variant:"outline",className:"text-xs",onClick:s,title:"Save the database",children:[e.jsx(Rt,{className:"h-3 w-3"}),"Save Database"]})]}),e.jsx(fs,{})]})},pe=ue(t=>({expandedTables:[],expandedTableSection:!0,expandedIndexSection:!0,toggleTable:s=>t(a=>({expandedTables:a.expandedTables.includes(s)?a.expandedTables.filter(o=>o!==s):[...a.expandedTables,s]})),toggleTableSection:()=>t(s=>({expandedTableSection:!s.expandedTableSection})),toggleIndexSection:()=>t(s=>({expandedIndexSection:!s.expandedIndexSection})),expandAllTables:s=>t({expandedTables:Object.keys(s)}),collapseAllTables:()=>t({expandedTables:[]}),resetState:()=>t({expandedTables:[],expandedTableSection:!0,expandedIndexSection:!0})})),E=r.memo(function({children:s,className:a}){return e.jsx("span",{className:`block max-w-80 overflow-hidden text-ellipsis ${a??""}`,children:s})}),gs={DATE:/DATE|TIMESTAMP/i,BLOB:/^BLOB$/i,TEXT:/CHAR|TEXT|CLOB|VARCHAR/i,INTEGER:/INT/i,REAL:/REAL|FLOAT|DOUBLE|DECIMAL/i,NUMERIC:/NUMERIC/i,BOOLEAN:/BOOL/i},P=(t,s)=>gs[s].test(t),js=t=>P(t,"DATE"),vs=t=>P(t,"BLOB"),Ns=t=>P(t,"TEXT"),ws=t=>P(t,"NUMERIC"),Ss=t=>P(t,"BOOLEAN"),ys=t=>P(t,"INTEGER"),Cs=t=>P(t,"REAL"),Ts=t=>ys(t)||Cs(t)||ws(t),Es=r.memo(Lt),Is=r.memo(zt),Rs=r.memo(Dt),Ls=r.memo(kt),zs=r.memo(At),Ds=r.memo(Pt),ks=r.memo(Mt),As=r.memo(Ot),fe=r.memo(({columnSchema:t})=>{if(!t)return null;const{type:s,isPrimaryKey:a,isForeignKey:o}=t;let n=null;return s&&(n=vs(s)?e.jsx(Rs,{className:"h-4 w-4 text-green-500"}):js(s)?e.jsx(Ls,{className:"h-4 w-4 text-blue-500"}):Ns(s)?e.jsx(zs,{className:"h-4 w-4 text-indigo-500"}):Ts(s)?e.jsx(Ds,{className:"h-4 w-4 text-red-500"}):Ss(s)?e.jsx(ks,{className:"h-4 w-4 text-pink-500"}):e.jsx(As,{className:"h-4 w-4 text-gray-500"})),e.jsxs("div",{className:"flex items-center gap-[2px]",children:[a&&e.jsx(Es,{className:"h-4 w-4 text-yellow-500"}),o&&e.jsx(Is,{className:"h-4 w-4 text-purple-500"}),n]})}),Ps=r.memo(({columnSchema:t})=>e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{columnSchema:t}),e.jsx("span",{className:"text-primary/60 ml-1 text-xs",children:t.name})]}),e.jsx(E,{className:"text-primary/60 text-xs whitespace-nowrap",children:t.type})]})),Ms=r.memo(ee),Os=r.memo(Re),Oe=r.memo(({expanded:t,size:s=4})=>t?e.jsx(Ms,{className:`h-${s} w-${s}`}):e.jsx(Os,{className:`h-${s} w-${s}`})),Fs=r.memo(({name:t,table:s})=>{const{expandedTables:a,toggleTable:o}=pe(),n=a.includes(t),c=()=>o(t),m=x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),o(t))};return e.jsxs("article",{children:[e.jsxs("div",{className:N("flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",n&&"ml-1"),onClick:c,onKeyDown:m,"aria-expanded":n,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(Oe,{expanded:n})}),e.jsxs("span",{className:"flex items-center gap-1 capitalize",children:[e.jsx("span",{className:"text-sm",children:t}),e.jsxs("span",{className:"text-primary/50 text-xs",children:["(",s.schema.length,")"]})]})]}),n&&e.jsx("div",{className:"border-primary/20 mt-1 mb-2 ml-4 flex flex-col gap-1 space-y-0.5 border-l-2 pl-2",children:s.schema.map(x=>e.jsx(Ps,{columnSchema:x},x.cid))})]})}),Fe=r.memo(({title:t,expanded:s,icon:a,onToggle:o,children:n})=>{const c=m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),o())};return e.jsxs("header",{className:N("hover:bg-primary/5 bg-primary/7 flex cursor-pointer items-center px-2 py-2 transition-colors",!s&&"mb-0"),onClick:o,onKeyDown:c,"aria-expanded":s,children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx(Oe,{expanded:s,size:5})}),a,e.jsx("span",{children:t}),n]})}),Bs=r.memo(({tablesSchema:t})=>{const{expandedTableSection:s,toggleTableSection:a,expandAllTables:o,collapseAllTables:n}=pe(),[c,m]=r.useState(!1),x=h=>{h.stopPropagation(),o(t),m(!0)},f=h=>{h.stopPropagation(),n(),m(!1)},u=s&&e.jsx("div",{className:"ml-auto flex",children:c?e.jsx(j,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:f,"aria-label":"Collapse all tables",children:e.jsx(Ut,{className:"h-4 w-4"})}):e.jsx(j,{className:"text-primary hover:bg-primary/5 h-7 rounded px-2 py-0.5 text-xs transition-colors",variant:"ghost",size:"icon",onClick:x,"aria-label":"Expand all tables",children:e.jsx(Ht,{className:"h-4 w-4"})})});return e.jsxs("section",{children:[e.jsx(Fe,{title:"Tables",expanded:s,icon:e.jsx(Ie,{className:"mr-2 h-4 w-4"}),onToggle:a,children:u}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:Object.entries(t).map(([h,p])=>e.jsx(Fs,{name:h,table:p},h))})]})}),Us=r.memo(({index:t})=>e.jsx("article",{children:e.jsx("div",{className:"flex cursor-pointer items-center rounded px-1.5 py-1 transition-all hover:ml-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[e.jsx("span",{className:"text-sm",children:t.name}),e.jsx(E,{className:"text-primary/60 text-xs font-medium whitespace-nowrap",children:t.tableName})]})})})),Hs=r.memo(({indexes:t})=>{const{expandedIndexSection:s,toggleIndexSection:a}=pe();return e.jsxs("section",{children:[e.jsx(Fe,{title:"Indexes",expanded:s,icon:e.jsx(Le,{className:"mr-2 h-4 w-4"}),onToggle:a}),s&&e.jsx("div",{className:"space-y-0.5 overflow-y-auto pr-1 pl-2",children:t.map(o=>e.jsx(Us,{index:o},o.name))})]})}),Qs=r.memo(({onFilterChange:t})=>e.jsxs("div",{className:"relative",children:[e.jsx(Ft,{className:"text-primary/40 absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2 transform"}),e.jsx(te,{placeholder:"Search tables and indexes",className:"border-primary/20 h-8 w-full pl-8 text-sm text-[0.8rem]!",onChange:s=>t(s.target.value),"aria-label":"Search tables and indexes"})]})),Vs=r.memo(({tableCount:t,indexCount:s})=>e.jsxs("footer",{className:"bg-primary/5 text-primary/60 flex items-center justify-between gap-2 border-t p-2 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bt,{className:"mr-1 h-3 w-3 text-wrap"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[t," Tables"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"mr-1 h-3 w-3"}),e.jsxs("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:[s," Indexes"]})]})]})),be=()=>{const[t,s]=r.useState(""),a=i(m=>m.tablesSchema),o=i(m=>m.indexesSchema),n=r.useMemo(()=>{if(!t)return a;const m={};for(const[x,f]of Object.entries(a))x.toLowerCase().includes(t.toLowerCase())&&(m[x]=f);return m},[a,t]),c=r.useMemo(()=>t?o.filter(m=>m.name.toLowerCase().includes(t.toLowerCase())||m.tableName.toLowerCase().includes(t.toLowerCase())):o,[o,t]);return e.jsxs("main",{className:"flex h-full w-full flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-primary/5 border-b p-2",children:e.jsx(Qs,{onFilterChange:s})}),e.jsxs("nav",{className:"flex-1 overflow-auto",children:[e.jsx(Bs,{tablesSchema:n}),o.length>0&&e.jsx(Hs,{indexes:c})]}),e.jsx(Vs,{tableCount:Object.keys(a).length,indexCount:o.length})]})},Gs=()=>e.jsx("div",{className:"flex h-full flex-col",children:e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(be,{})})})});function ie({className:t,...s}){return e.jsx(Jt,{"data-slot":"resizable-panel-group",className:N("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...s})}function U(t){return e.jsx(Zt,{"data-slot":"resizable-panel",...t})}function ce({withHandle:t,className:s,...a}){return e.jsx(es,{"data-slot":"resizable-handle",className:N("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",s),...a,children:t&&e.jsx("div",{className:"bg-border border-primary/20 z-50 flex h-9 w-4 items-center justify-center rounded-xs border",children:e.jsx(Qt,{className:"size-2.5"})})})}function _s({...t}){return e.jsx(it,{"data-slot":"select",...t})}function Ws({...t}){return e.jsx(mt,{"data-slot":"select-value",...t})}function $s({className:t,children:s,...a}){return e.jsxs(ct,{"data-slot":"select-trigger",className:N("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a,children:[s,e.jsx(dt,{asChild:!0,children:e.jsx(ee,{className:"size-4 opacity-50"})})]})}function Ks({className:t,children:s,position:a="popper",...o}){return e.jsx(ut,{children:e.jsxs(xt,{"data-slot":"select-content",className:N("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...o,children:[e.jsx(Xs,{}),e.jsx(ht,{className:N("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(Ys,{})]})})}function qs({className:t,children:s,...a}){return e.jsxs(pt,{"data-slot":"select-item",className:N("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(ft,{children:e.jsx(Gt,{className:"size-4"})})}),e.jsx(bt,{children:s})]})}const Xs=me.memo(function({className:s,...a}){return e.jsx(ot,{"data-slot":"select-scroll-up-button",className:N("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Vt,{className:"size-4"})})});function Ys({className:t,...s}){return e.jsx(gt,{"data-slot":"select-scroll-down-button",className:N("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ee,{className:"size-4"})})}const Js=()=>{const{handleTableChange:t}=R(),s=i(n=>n.tablesSchema),a=i(n=>n.currentTable);return r.useMemo(()=>e.jsxs(_s,{onValueChange:t,value:a||void 0,children:[e.jsx($s,{className:"border-primary/20 h-8 w-30 border text-sm sm:w-48",children:e.jsx(Ws,{placeholder:"Select Table"})}),e.jsx(Ks,{children:Object.keys(s).map(n=>e.jsx(qs,{value:n,children:e.jsx(E,{className:"capitalize",children:n})},n))})]}),[s,a,t])};function Zs({...t}){return e.jsx(jt,{"data-slot":"dropdown-menu",...t})}function ea({...t}){return e.jsx(vt,{"data-slot":"dropdown-menu-trigger",...t})}function ta({className:t,sideOffset:s=4,...a}){return e.jsx(Nt,{children:e.jsx(wt,{"data-slot":"dropdown-menu-content",sideOffset:s,className:N("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...a})})}function $({className:t,inset:s,variant:a="default",...o}){return e.jsx(St,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":a,className:N("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...o})}const sa=()=>{const{handleExport:t}=R(),{isInserting:s,handleInsert:a}=Q(),o=i(f=>f.filters),n=i(f=>f.setFilters),c=i(f=>f.sorters),m=i(f=>f.setSorters);return r.useMemo(()=>e.jsxs(Zs,{children:[e.jsx(ea,{asChild:!0,children:e.jsxs(j,{variant:"outline",size:"sm",className:"h-8 text-xs",children:["Actions ",e.jsx(ee,{className:"ml-1 h-3 w-3"})]})}),e.jsxs(ta,{className:"w-40",children:[e.jsx($,{asChild:!0,children:e.jsxs(j,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>n(null),disabled:o==null,title:"Clear applied filters",children:[e.jsx(xe,{className:"mr-1 h-3 w-3"}),"Clear filters"]})}),e.jsx($,{asChild:!0,children:e.jsxs(j,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>m(null),disabled:c==null,title:"Reset sorting",children:[e.jsx(ze,{className:"mr-1 h-3 w-3"}),"Reset sorting"]})}),e.jsx($,{asChild:!0,children:e.jsxs(j,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:a,disabled:s,title:"Insert a new row",children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]})}),e.jsx($,{asChild:!0,children:e.jsxs(j,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("table"),title:"Export the current table as CSV",children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Export table"]})}),e.jsx($,{asChild:!0,children:e.jsxs(j,{variant:"ghost",size:"sm",className:"h-8 w-full justify-start text-xs",onClick:()=>t("current"),title:"Export the current data as CSV",children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Export data"]})})]})]}),[o,c,t,a,s,n,m])},aa=()=>{const{handleEditSubmit:t}=R(),{selectedRowObject:s,isInserting:a,handleCloseEdit:o}=Q(),n=T(d=>d.editValues),c=T(d=>d.setEditValues),m=i(d=>d.tablesSchema),x=i(d=>d.currentTable),f=i(d=>d.columns);r.useEffect(()=>{a?c((f==null?void 0:f.map(()=>""))||[]):s&&c(s.data.map(d=>(d==null?void 0:d.toString())??""))},[a,s,f,c]);const u=r.useCallback((d,S)=>{const w=T.getState().editValues;c(w.map((M,L)=>L===d?S:M))},[c]),h=r.useMemo(()=>!f||!x||!m[x]?null:f.map((d,S)=>{var w;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:d,className:"bg-primary/5 flex items-center gap-1 rounded-sm p-2",children:[e.jsx(fe,{columnSchema:(w=m[x])==null?void 0:w.schema[S]}),e.jsx(E,{className:"text-xs font-medium capitalize",children:d})]}),e.jsx(te,{id:d,name:d,className:"border-primary/20 h-8 rounded-none text-sm text-[0.8rem]!",value:n[S]||"",onChange:M=>u(S,M.target.value)})]},d)}),[f,x,m,n,u]),p=r.useMemo(()=>e.jsxs("div",{className:"flex w-full",children:[e.jsx(j,{size:"sm",variant:"outline",className:"w-full text-xs",onClick:()=>t(a?"insert":"update"),"aria-label":a?"Insert row":"Apply changes",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-1 h-3 w-3"}),"Apply changes"]})}),!a&&e.jsx(j,{size:"sm",variant:"destructive",className:"rounded-none text-xs",onClick:()=>t("delete"),"aria-label":"Delete row",children:e.jsx(_t,{className:"h-3 w-3"})})]}),[t,a]),v=r.useMemo(()=>e.jsxs("div",{className:"bg-primary/5 flex w-full items-center justify-between gap-1 border-b p-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(E,{className:"whitespace-nowrap",children:"Inserting row"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx(E,{className:"whitespace-nowrap",children:"Updating row"})]})}),e.jsx(j,{size:"sm",variant:"outline",className:"text-xs",onClick:o,title:"Go back to data","aria-label":"Go back to data",children:e.jsx(De,{className:"h-3 w-3"})})]}),[a,o]);return e.jsx("section",{className:"h-full overflow-auto",children:e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsxs("div",{className:"overflow-auto",children:[v,h]}),p]})})},Be=r.memo(function({className:s,...a}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:N("w-full caption-bottom text-sm",s),...a})})}),Ue=r.memo(function({className:s,...a}){return e.jsx("thead",{"data-slot":"table-header",id:"tableHeader",className:N("[&_tr]:border-b",s),...a})}),He=r.memo(function({className:s,...a}){return e.jsx("tbody",{"data-slot":"table-body",className:N("[&_tr:last-child]:border-0",s),...a})});r.memo(function({className:s,...a}){return e.jsx("tfoot",{"data-slot":"table-footer",className:N("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",s),...a})});const H=r.memo(function({className:s,...a}){return e.jsx("tr",{"data-slot":"table-row",className:N("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...a})}),de=r.memo(function({className:s,...a}){return e.jsx("th",{"data-slot":"table-head",className:N("text-muted-foreground min-h-6 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),Z=r.memo(function({className:s,...a}){return e.jsx("td",{"data-slot":"table-cell",id:"tableCell",className:N("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})}),na=r.memo(({column:t,value:s,onChange:a})=>{const o=r.useCallback(n=>a(t,n.target.value),[t,a]);return e.jsx(te,{type:"text",className:"border-primary/20 max-h-6 w-full rounded px-2 py-1 text-[0.8rem]!",value:s,onChange:o,placeholder:"Filter"})}),ra=r.memo(Wt),la=r.memo($t),oa=r.memo(Kt),ia=r.memo(({column:t})=>{const s=i(o=>o.sorters),{handleQuerySorter:a}=R();return e.jsx(e.Fragment,{children:s!=null&&s[t]?s[t]==="asc"?e.jsx("button",{title:"Sort column in descending order",type:"button","aria-label":"Sort Descending",onClick:()=>a(t),children:e.jsx(oa,{className:"h-4 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Ascending",onClick:()=>a(t),children:e.jsx(la,{className:"h-3 w-3"})}):e.jsx("button",{title:"Sort column in ascending order",type:"button","aria-label":"Sort Column",onClick:()=>a(t),children:e.jsx(ra,{className:"h-3 w-3"})})})}),ca=()=>{const t=i(p=>p.data),s=i(p=>p.columns),a=i(p=>p.currentTable),o=i(p=>p.tablesSchema),n=i(p=>p.filters),c=i(p=>p.setFilters),{handleQueryFilter:m}=R(),{handleRowClick:x,selectedRowObject:f}=Q(),u=r.useMemo(()=>e.jsx("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:n?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-md font-medium",children:"No Data To Show For Current Filters"}),e.jsxs(j,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>c(null),children:[e.jsx(xe,{className:"mr-1 h-3 w-3"}),"Clear filters"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-md font-medium",children:"No Data To Show"}),e.jsx("p",{className:"text-sm",children:"This table does not have any data to display"})]})}),[n,c]),h=r.useMemo(()=>(s||[]).map(p=>e.jsx(na,{column:p,value:(n==null?void 0:n[p])||"",onChange:m},p)),[s,n,m]);return r.useMemo(()=>e.jsxs(Be,{children:[e.jsx(Ue,{children:e.jsx(H,{className:"bg-primary/5",children:s&&a?s.map((p,v)=>e.jsxs(de,{className:"p-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 py-[1.5px]",children:[e.jsx(ia,{column:p}),e.jsx(E,{className:"text-foreground font-medium capitalize",children:p}),e.jsx(fe,{columnSchema:o[a].schema[v]})]}),h==null?void 0:h[v]]},p)):e.jsx(de,{children:e.jsx("p",{className:"text-xs",children:"No columns found"})})})}),e.jsx(He,{children:t&&t.length>0?t.map((p,v)=>e.jsx(H,{onClick:()=>x(p,v),className:`hover:bg-primary/5 cursor-pointer text-xs ${(f==null?void 0:f.index)===v?"bg-primary/5":""}`,children:p.map((d,S)=>{var w;return e.jsx(Z,{className:"p-2",children:d?e.jsx(e.Fragment,{children:((w=o[a].schema[S])==null?void 0:w.type)==="BLOB"?e.jsx("span",{className:"text-muted-foreground italic",children:"BLOB"}):e.jsx(E,{children:d})}):e.jsx("span",{className:"text-muted-foreground italic",children:"NULL"})},S)})},v)):e.jsx(H,{children:e.jsx(Z,{colSpan:(s==null?void 0:s.length)||1,className:"h-32 text-center",children:u})})})]}),[t,s,a,o,x,f,u,h])},da=()=>{const{handlePageChange:t,handleExport:s}=R(),{isInserting:a,handleInsert:o}=Q(),n=i(u=>u.offset),c=i(u=>u.limit),m=i(u=>u.maxSize),x=i(u=>u.isDataLoading);return r.useMemo(()=>e.jsxs("footer",{className:"bg-background flex w-full items-center justify-between border-t",id:"paginationControls",children:[e.jsxs("section",{className:"bg-primary/10 flex grow items-center gap-1 p-2",children:[e.jsx(j,{onClick:()=>t("first"),disabled:n===0||x,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the first data",children:e.jsx(qt,{className:"h-4 w-4"})}),e.jsx(j,{onClick:()=>t("prev"),disabled:n===0||x,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the previous data",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-2 text-xs whitespace-nowrap",children:[n+1," -> ",n+c>m?m:n+c," of ",m]}),e.jsx(j,{onClick:()=>t("next"),disabled:n+c>=m||x,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the next data",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx(j,{onClick:()=>t("last"),disabled:n+c>=m||x,size:"icon",variant:"outline",className:"h-7 w-7",title:"Go to the last data",children:e.jsx(Xt,{className:"h-4 w-4"})})]}),e.jsxs("section",{className:"bg-primary/10 hidden items-center gap-1 p-2 md:flex",children:[e.jsxs(j,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:o,disabled:a,children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),"Insert row"]}),e.jsxs(j,{onClick:()=>s("current"),size:"sm",variant:"outline",className:"h-7 text-xs",title:"Export current data as CSV",children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Export data"]})]})]}),[m,t,x,s,a,n,c,o])},ma=r.memo(()=>{const t=i(d=>d.filters),s=i(d=>d.sorters),a=i(d=>d.setFilters),o=i(d=>d.setSorters),n=i(d=>d.isDataLoading),c=i(d=>d.isDatabaseLoading),m=T(d=>d.dataPanelSize),x=T(d=>d.schemaPanelSize),f=T(d=>d.setDataPanelSize),u=T(d=>d.setSchemaPanelSize),{handleExport:h}=R(),{isEditing:p}=Q(),v=r.useMemo(()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden items-center gap-1 md:flex",children:[e.jsxs(j,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>a(null),disabled:t==null,title:"Clear applied filters",children:[e.jsx(xe,{className:"mr-1 h-3 w-3"}),"Clear filters"]}),e.jsxs(j,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>o(null),disabled:s==null,title:"Reset sorting",children:[e.jsx(ze,{className:"mr-1 h-3 w-3"}),"Reset sorting"]}),e.jsxs(j,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>h("table"),title:"Export the current table as CSV",children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Export table"]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(sa,{})})]}),[t,s,a,o,h]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsx(Js,{}),v,(n||c)&&e.jsx(ua,{text:"Loading data"})]}),e.jsx("div",{className:"relative h-full overflow-hidden",children:e.jsxs(ie,{direction:"horizontal",className:"h-full",children:[e.jsx(U,{id:"dataPanel",defaultSize:m,onResize:f,children:e.jsxs("div",{className:"flex h-full flex-col justify-between border-l",id:"dataSection",children:[e.jsx(ca,{}),e.jsx(da,{})]})}),e.jsx(ce,{withHandle:!0}),e.jsxs(U,{id:"schemaPanel",defaultSize:x,onResize:u,className:T.getState().isMobile?"":"relative",children:[e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(be,{})})}),e.jsx("div",{className:`bg-background absolute top-0 right-0 z-40 h-full w-full ${p?"block":"hidden"}`,children:e.jsx("section",{className:"bg-primary/5 h-full",children:e.jsx(aa,{})})})]})]})})]})}),ua=({text:t})=>e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(he,{className:"mr-1 h-3 w-3 animate-spin"}),t]}),xa=["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"],ha=["ABS","ACOS","ASIN","ATAN","CEIL","COS","EXP","FLOOR","HEX","LENGTH","LOG","LOWER","LTRIM","OCT","PI","POW","ROUND","SIGN","SIN","SQRT","TAN","TRIM","UPPER"];function pa(){const{theme:t}=Ae(),s=i(h=>h.customQuery),a=i(h=>h.setCustomQuery),o=i(h=>h.tablesSchema),{tableNames:n,columnNames:c}=r.useMemo(()=>{const h=Object.keys(o),p=h.flatMap(v=>o[v].schema.map(d=>d.name));return{tableNames:h,columnNames:p}},[o]),m=r.useMemo(()=>[...xa.map(h=>({label:h,type:"keyword"})),...ha.map(h=>({label:h,type:"function"})),...n.map(h=>({label:h,type:"table"})),...c.map(h=>({label:h,type:"column"}))],[n,c]),x=r.useCallback(h=>{const p=h.matchBefore(/\w*/);return!p||p.from===p.to&&!h.explicit?null:{from:p.from,to:p.to,options:m}},[m]),f=r.useCallback(h=>{a(h)},[a]),u=r.useMemo(()=>[as,ns(),rs({override:[x]})],[x]);return e.jsx(ts,{value:s,height:"100%",extensions:u,onChange:f,className:"h-full w-full",theme:t==="dark"?ss:"light"})}const fa=()=>{const t=i(s=>s.customQueryObject);return r.useMemo(()=>{var s;return e.jsx(e.Fragment,{children:t?e.jsxs(Be,{children:[e.jsx(Ue,{children:e.jsx(H,{className:"bg-primary/5",children:t.columns.map(a=>e.jsx(de,{className:"p-1 text-xs",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(E,{className:"text-foreground font-medium capitalize",children:a})})},a))})}),e.jsx(He,{children:t.data&&t.data.length>0?t.data.map((a,o)=>e.jsx(H,{className:"hover:bg-primary/5 text-xs",children:a.map((n,c)=>e.jsx(Z,{className:"p-2",children:n?e.jsx(E,{children:n}):e.jsx("span",{className:"text-muted-foreground italic",children:"NULL"})},c))},o)):e.jsx(H,{children:e.jsx(Z,{colSpan:((s=t==null?void 0:t.columns)==null?void 0:s.length)||1,className:"h-32 text-center",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:[e.jsx("p",{className:"text-md whitespace-nowrap",children:"No Data To Show"}),e.jsx("p",{className:"text-sm whitespace-nowrap",children:"Seems like there is no data to display"})]})})})})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-1 px-4",children:[e.jsx("p",{className:"text-md whitespace-nowrap",children:"No Data To Show"}),e.jsx("p",{className:"text-sm whitespace-nowrap",children:"Execute a query to view data"})]})})},[t])},ba=()=>{const t=i(u=>u.customQueryObject),s=i(u=>u.errorMessage),a=i(u=>u.isDataLoading),o=i(u=>u.isDatabaseLoading),n=T(u=>u.dataPanelSize),c=T(u=>u.schemaPanelSize),m=T(u=>u.setDataPanelSize),x=T(u=>u.setSchemaPanelSize),{handleQueryExecute:f}=R();return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center gap-1 border-b px-1 py-2",children:[e.jsxs(j,{size:"sm",variant:"outline",className:"text-xs",onClick:f,title:"Execute SQL",children:[e.jsx(Yt,{className:"mr-1 h-3 w-3"}),"Execute SQL"]}),e.jsxs(j,{size:"sm",variant:"outline",className:"text-xs",disabled:!(t!=null&&t.data),children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Export data"]}),(a||o)&&e.jsxs("span",{className:"ml-2 flex items-center text-xs text-gray-500",children:[e.jsx(he,{className:"mr-1 h-3 w-3 animate-spin"}),"Loading data"]})]}),e.jsx("div",{className:"h-full overflow-hidden",children:e.jsxs(ie,{direction:"horizontal",className:"h-full",children:[e.jsx(U,{defaultSize:n,onResize:m,children:e.jsxs(ie,{direction:"vertical",children:[e.jsxs(U,{defaultSize:25,children:[s&&e.jsx("div",{className:"p-2 text-sm text-red-400",children:s}),e.jsx(pa,{})]}),e.jsx(ce,{withHandle:!0}),e.jsx(U,{defaultSize:75,children:e.jsx("div",{className:"flex h-full flex-col justify-between border",children:e.jsx(fa,{})})})]})}),e.jsx(ce,{withHandle:!0}),e.jsx(U,{defaultSize:c,onResize:x,className:"",children:e.jsx("div",{className:"h-full overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(be,{})})})})]})})]})};function ga(){const t=i(s=>s.isDatabaseLoading);return e.jsxs("main",{className:"bg-primary/5 flex h-screen flex-col overflow-hidden",children:[e.jsx(bs,{}),e.jsxs(ms,{defaultValue:"data",className:"flex flex-1 flex-col",children:[e.jsxs(us,{className:"bg-primary/5 mt-2 h-9 w-full justify-start rounded-none border-b",children:[e.jsx(le,{id:"structure",disabled:t,value:"structure",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",children:"Database Structure"},"structure"),e.jsx(le,{id:"data",disabled:t,value:"data",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",children:"Browse Data"},"data"),e.jsx(le,{disabled:t,id:"execute",value:"execute",className:"data-[state=active]: data-[state=active]:border-primary h-8 rounded-none text-xs data-[state=active]:border-b-2",children:"Execute SQL"},"execute")]}),e.jsxs("div",{className:"max-h-custom-dvh flex-1 overflow-hidden",children:[e.jsx(oe,{value:"data",className:"m-0 h-full border-none p-0",children:t?e.jsx(ja,{message:"Loading Database"}):e.jsx(ma,{})}),e.jsx(oe,{value:"structure",className:"m-0 h-full border-none p-0",children:e.jsx(Gs,{})}),e.jsx(oe,{value:"execute",className:"m-0 h-full border border-none p-0",children:e.jsx(ba,{})})]})]})]})}const ja=({message:t})=>e.jsxs("div",{className:"flex h-full items-center justify-center",children:[e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-xl",children:t})]});Ze.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsxs(is,{defaultTheme:"dark",storageKey:"ui-theme",children:[e.jsx(cs,{children:e.jsx(ds,{children:e.jsx(ga,{})})}),e.jsx(ls,{richColors:!0})]})}));
